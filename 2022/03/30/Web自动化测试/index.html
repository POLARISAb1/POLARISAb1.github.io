<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="1. Selenium的安装1.1 Selenium的简介 官方网站：  https:&#x2F;&#x2F;www.selenium.dev&#x2F; 简介 用于web浏览器测试的工具 支持的浏览器包括IE，Firefox，Safari，Chrome，Edge等 使用简单，可使用Java，Python等多种语言编写用例脚本 主要由三个工具构成：WebDriver、IDE、Grid    1.2 Selenium架构  1.">
<meta property="og:type" content="article">
<meta property="og:title" content="web自动化测试">
<meta property="og:url" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/index.html">
<meta property="og:site_name" content="杨艺琳的博客">
<meta property="og:description" content="1. Selenium的安装1.1 Selenium的简介 官方网站：  https:&#x2F;&#x2F;www.selenium.dev&#x2F; 简介 用于web浏览器测试的工具 支持的浏览器包括IE，Firefox，Safari，Chrome，Edge等 使用简单，可使用Java，Python等多种语言编写用例脚本 主要由三个工具构成：WebDriver、IDE、Grid    1.2 Selenium架构  1.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330110837429.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330112032113.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330113142937.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330113204520.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330113333105.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330113416609.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330113929913.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330114139974.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330144504950.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330145700022.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330145730227.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330145842890.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330150030050.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330150257156.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330150439077.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330150539375.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330150642356.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330152258425.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330152228474.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330152427650.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330152448271.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330152723889.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330152850868.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330153607433.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330154434819.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401104833012.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401110134896.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401132554549.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401134502450.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401140209612.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401141033393.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401141544857.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401142008458.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401143236014.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401143839958.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401145218205.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401145302501.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401145924333.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401161757286.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220406135402787.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220406162834245.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220406160843525.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220406160828526.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220407105604381.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220407141602262.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220407141835337.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220407162024089.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220407163523147.png">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/POv1Qi9G48RtESLSe0krgooyX2SGSI5O1MttGaEh9h4BOw0QAn74eAql8g8s5Y_Zp9kiUWKJeaNiRhxX__wPVE6nMWDQwonwk9b8JyTjKxbXkCk2tDiHiFXYhw52AcPyUUVN6ROzDEp4OArFpgTodOtTNB5Sh9IU7bH80_lFqlBgvmsrfkmQVotA9HbRs3BbN8JkEXoELSW0Ybq2q.svg">
<meta property="og:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/UxAdyScEMK_thNkoV-6J7RjVBjpwSkuY1LqxXPSDirwiM_zqxrIea9M2eTxpffrFstV3PRYUuDByRFlkfrqBddLCU3fn1aJKIi48gXrPZWlT5XnwZR7fnLI8nTrM2YPwJnUkVjes4wBmnTQMPzDclj_J0p7moVwvJzTYTGQ6EQPwB_gsF-sV1Z7dQSVq5mjNF9ksziMA1W00.svg">
<meta property="article:published_time" content="2022-03-30T02:59:02.000Z">
<meta property="article:modified_time" content="2022-04-11T13:26:46.000Z">
<meta property="article:author" content="杨艺琳">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330110837429.png">

<link rel="canonical" href="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>web自动化测试 | 杨艺琳的博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">杨艺琳的博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">放弃不难<br>但坚持一定很酷</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="杨艺琳">
      <meta itemprop="description" content="我就是这条街最靓的仔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="杨艺琳的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          web自动化测试
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-03-30 10:59:02" itemprop="dateCreated datePublished" datetime="2022-03-30T10:59:02+08:00">2022-03-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-04-11 21:26:46" itemprop="dateModified" datetime="2022-04-11T21:26:46+08:00">2022-04-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="1-Selenium的安装"><a href="#1-Selenium的安装" class="headerlink" title="1. Selenium的安装"></a>1. Selenium的安装</h1><h2 id="1-1-Selenium的简介"><a href="#1-1-Selenium的简介" class="headerlink" title="1.1 Selenium的简介"></a>1.1 Selenium的简介</h2><ul>
<li>官方网站：<br>  <a target="_blank" rel="noopener" href="https://www.selenium.dev/">https://www.selenium.dev/</a></li>
<li>简介<ul>
<li>用于web浏览器测试的工具</li>
<li>支持的浏览器包括IE，Firefox，Safari，Chrome，Edge等</li>
<li>使用简单，可使用Java，Python等多种语言编写用例脚本</li>
<li>主要由三个工具构成：WebDriver、IDE、Grid</li>
</ul>
</li>
</ul>
<h2 id="1-2-Selenium架构"><a href="#1-2-Selenium架构" class="headerlink" title="1.2 Selenium架构"></a>1.2 Selenium架构</h2><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330110837429.png" alt="image-20220330110837429" style="zoom:50%;">

<h2 id="1-3-Selenium环境配置步骤"><a href="#1-3-Selenium环境配置步骤" class="headerlink" title="1.3 Selenium环境配置步骤"></a>1.3 Selenium环境配置步骤</h2><ol>
<li>准备好python环境配置</li>
<li>准备好selenium环境</li>
<li>下载浏览器对应的driver版本</li>
<li>driver配置环境变量</li>
<li>在python中import对应的依赖</li>
</ol>
<h2 id="1-4-Selenium的安装"><a href="#1-4-Selenium的安装" class="headerlink" title="1.4  Selenium的安装"></a>1.4  Selenium的安装</h2><ul>
<li><p>前提</p>
<ul>
<li>配置好python环境</li>
<li>配置好pip工具</li>
</ul>
</li>
<li><p>安装</p>
  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip --<span class="keyword">default</span>-timeout=<span class="number">100</span> install selenium==<span class="number">3.141</span><span class="number">.0</span> -i http:<span class="comment">//pypi.douban.com/simple/ --trusted-host pypi.douban.com</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>检查是否安装</p>
<ul>
<li><p><code>pip show selenium</code></p>
<p>  <img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330112032113.png" alt="image-20220330112032113"></p>
</li>
</ul>
</li>
</ul>
<h2 id="1-5-Driver的配置"><a href="#1-5-Driver的配置" class="headerlink" title="1.5 Driver的配置"></a>1.5 Driver的配置</h2><ul>
<li><p>Driver的介绍</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.selenium.dev/documentation/en/webdriver/driver_requirements/">https://www.selenium.dev/documentation/en/webdriver/driver_requirements/</a></li>
</ul>
</li>
<li><p>Chrome Driver的下载</p>
<ul>
<li>淘宝镜像：<a target="_blank" rel="noopener" href="https://npm.taobao.org/mirrors/chromedriver/">https://npm.taobao.org/mirrors/chromedriver/</a></li>
<li>官方网站：<a target="_blank" rel="noopener" href="https://chromedriver.storage.googleapis.com/index.html">https://chromedriver.storage.googleapis.com/index.html</a></li>
</ul>
</li>
<li><p>FireFox Driver的下载</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/mozilla/geckodriver/releases">https://github.com/mozilla/geckodriver/releases</a></li>
</ul>
</li>
<li><p>Driver的安装</p>
<ul>
<li><p>先找和自己浏览器版本适配的driver版本</p>
<ul>
<li><p>首先查看自己的浏览器版本(Google)</p>
  <img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330113142937.png" alt="image-20220330113142937" style="zoom:47%;">

  <img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330113204520.png" alt="image-20220330113204520" style="zoom:50%;">
</li>
<li><p>在去淘宝镜像找到符合浏览器版本的driver进行下载</p>
  <img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330113333105.png" alt="image-20220330113333105" style="zoom:50%;">

  <img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330113416609.png" alt="image-20220330113416609" style="zoom:50%;"></li>
</ul>
</li>
<li><p>导入到环境变量中(Mac || windows)</p>
<ul>
<li><p>Windows</p>
<ul>
<li><p>先找到刚下载的driver解压后地址</p>
  <img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330113929913.png" alt="image-20220330113929913" style="zoom:50%;">
</li>
<li><p>再将该地址添加到环境变量 <code>path</code> 中</p>
</li>
<li><p>验证是否配置成功</p>
<ul>
<li>在cmd中，输入 <code>chromedriver --version</code></li>
</ul>
<p>  <img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330114139974.png" alt="image-20220330114139974"></p>
</li>
</ul>
</li>
<li><p>MAC</p>
<ul>
<li><code>vim ~/.bash_profile export PATH=$PATH:[chromedriver所在路径]</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="1-6-selenium在python中如何使用"><a href="#1-6-selenium在python中如何使用" class="headerlink" title="1.6 selenium在python中如何使用"></a>1.6 selenium在python中如何使用</h2><ul>
<li><p>导入selenium</p>
</li>
<li><p>实例化driver</p>
</li>
<li><p>打开网址</p>
</li>
<li><p>关闭driver</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入Selenium包</span></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_selenium</span>():</span><br><span class="line">    <span class="comment"># 创建一个Chromedriver的实例。Chrome()会从环境变量中寻找浏览器</span></span><br><span class="line">    driver = webdriver.Chrome()</span><br><span class="line">    <span class="comment"># driver=webdriver.Ie()    #打开IE浏览器</span></span><br><span class="line">    <span class="comment"># driver=webdriver.Firefox()     #打开Firefox浏览器</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打开网址</span></span><br><span class="line">    driver.get(<span class="string">&quot;https://www.baidu.com/&quot;</span>)</span><br><span class="line">    <span class="comment"># 关闭driver</span></span><br><span class="line">    driver.quit()</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="2-SeleniumIDE的用例录制"><a href="#2-SeleniumIDE的用例录制" class="headerlink" title="2. SeleniumIDE的用例录制"></a>2. SeleniumIDE的用例录制</h1><h2 id="2-1-SeleniumlDE用例录制使用场景"><a href="#2-1-SeleniumlDE用例录制使用场景" class="headerlink" title="2.1 SeleniumlDE用例录制使用场景"></a>2.1 SeleniumlDE用例录制使用场景</h2><ul>
<li>刚开始入门UI自动化测试</li>
<li>团队代码基础较差</li>
<li>技术成长之后学习价值不高</li>
</ul>
<h2 id="2-2-SeleniumIDE的下载及安装"><a href="#2-2-SeleniumIDE的下载及安装" class="headerlink" title="2.2 SeleniumIDE的下载及安装"></a>2.2 SeleniumIDE的下载及安装</h2><ul>
<li><p>官网：<a target="_blank" rel="noopener" href="https://www.selenium.dev/">https://www.selenium.dev/</a></p>
</li>
<li><p>Chrome插件：<a target="_blank" rel="noopener" href="https://chrome.google.com/webstore/detail/selenium-ide/mooikfkahbdckldjjndioackbalphokd">https://chrome.google.com/webstore/detail/selenium-ide/mooikfkahbdckldjjndioackbalphokd</a></p>
</li>
<li><p>Firefox:<a target="_blank" rel="noopener" href="https://addons.mozilla.org/en-US/firefox/addon/selenium-ide/">https://addons.mozilla.org/en-US/firefox/addon/selenium-ide/</a></p>
</li>
<li><p>github release:<a target="_blank" rel="noopener" href="https://github.com/SeleniumHQ/selenium-ide/releases">https://github.com/SeleniumHQ/selenium-ide/releases</a></p>
</li>
<li><p>其它版本：<a target="_blank" rel="noopener" href="https://addons.mozilla.org/en-GB/firefox/addon/selenium-ide/versions/">https://addons.mozilla.org/en-GB/firefox/addon/selenium-ide/versions/</a></p>
<blockquote>
<p>注意：Chrome插件在国内无法下载，Firefox可以直接下载。</p>
</blockquote>
</li>
</ul>
<h2 id="2-3-启动"><a href="#2-3-启动" class="headerlink" title="2.3 启动"></a>2.3 启动</h2><ul>
<li>安装完成后，通过在浏览器的菜单栏中点击它的图标来启动它：</li>
<li>如果没看到图标，首先确保是否安装了Selenium IDE 扩展插件</li>
<li>通过以下链接访问所有插件</li>
<li>Chrome：chrome:&#x2F;&#x2F;extensions</li>
<li>Firefox：about:addons</li>
</ul>
<h2 id="2-4-SeleniumIDE常用功能"><a href="#2-4-SeleniumIDE常用功能" class="headerlink" title="2.4 SeleniumIDE常用功能"></a>2.4 SeleniumIDE常用功能</h2><p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330144504950.png" alt="image-20220330144504950"></p>
<ol>
<li>新建、保存、打开</li>
<li>开始和停止录制</li>
<li>运行8中的所有的实例</li>
<li>运行单个实例</li>
<li>调试模式</li>
<li>调整案例的运行速度</li>
<li>要录制的网址</li>
<li>实例列表</li>
<li>动作、目标、值</li>
<li>对单条命令的解释</li>
<li>运行日志</li>
</ol>
<h2 id="2-5-使用SeleniumIDE"><a href="#2-5-使用SeleniumIDE" class="headerlink" title="2.5 使用SeleniumIDE"></a>2.5 使用SeleniumIDE</h2><h3 id="step1：创建项目"><a href="#step1：创建项目" class="headerlink" title="step1：创建项目"></a>step1：创建项目</h3><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330145700022.png" alt="image-20220330145700022" style="zoom: 43%;">

<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330145730227.png" alt="image-20220330145730227" style="zoom:43%;">

<h3 id="step2：开始录制"><a href="#step2：开始录制" class="headerlink" title="step2：开始录制"></a>step2：开始录制</h3><p>点击开始录制</p>
<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330145842890.png" alt="image-20220330145842890" style="zoom:43%;">

<p>填入测试的URL，点击开始录制</p>
<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330150030050.png" alt="image-20220330150030050" style="zoom:43%;">

<p>在录制时，浏览器右下角会出现正在录制的标志</p>
<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330150257156.png" alt="image-20220330150257156" style="zoom:33%;">

<h3 id="step3：结束录制"><a href="#step3：结束录制" class="headerlink" title="step3：结束录制"></a>step3：结束录制</h3><p>点击”结束录制“按钮</p>
<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330150439077.png" alt="image-20220330150439077" style="zoom:43%;">

<p>给测试用例起个名字</p>
<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330150539375.png" alt="image-20220330150539375" style="zoom:43%;">

<h3 id="step4：回放"><a href="#step4：回放" class="headerlink" title="step4：回放"></a>step4：回放</h3><p>点击”回放按钮“会进行回放操作</p>
<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330150642356.png" alt="image-20220330150642356" style="zoom:43%;">

<p>也可以进行新建命令</p>
<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330152258425.png" alt="image-20220330152258425" style="zoom: 50%;">

<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330152228474.png" alt="image-20220330152228474" style="zoom:50%;">

<h3 id="step5：新建测试"><a href="#step5：新建测试" class="headerlink" title="step5：新建测试"></a>step5：新建测试</h3><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330152427650.png" alt="image-20220330152427650" style="zoom:50%;">

<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330152448271.png" alt="image-20220330152448271" style="zoom:50%;">

<p>接下来仍然是通过录制的方式获取测试</p>
<p>获取到测试后，可以选择批量执行</p>
<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330152723889.png" alt="image-20220330152723889" style="zoom:50%;">

<h3 id="step5：创建测试集"><a href="#step5：创建测试集" class="headerlink" title="step5：创建测试集"></a>step5：创建测试集</h3><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330152850868.png" alt="image-20220330152850868" style="zoom:50%;">

<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330153607433.png" alt="image-20220330153607433" style="zoom:50%;">

<p>回放操作和测试的完全一致</p>
<h3 id="step6：导出"><a href="#step6：导出" class="headerlink" title="step6：导出"></a>step6：导出</h3><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220330154434819.png" alt="image-20220330154434819" style="zoom:50%;">



<h1 id="3-Selenium测试用例编写"><a href="#3-Selenium测试用例编写" class="headerlink" title="3. Selenium测试用例编写"></a>3. Selenium测试用例编写</h1><h2 id="3-1-测试用例的核心要素"><a href="#3-1-测试用例的核心要素" class="headerlink" title="3.1 测试用例的核心要素"></a>3.1 测试用例的核心要素</h2><ul>
<li>一条测试用例的最终结果只有一个：成功或者失败，</li>
<li>三大核心要素为：标题、步骤、断言<ul>
<li>标题：是对测试用例的描述</li>
<li>步骤：对测试执行过程进行描述</li>
<li>断言：实际结果与预期结果对比</li>
</ul>
</li>
</ul>
<h2 id="3-2-Selenium中如何编写测试用例"><a href="#3-2-Selenium中如何编写测试用例" class="headerlink" title="3.2 Selenium中如何编写测试用例"></a>3.2 Selenium中如何编写测试用例</h2><ul>
<li>步骤：<ul>
<li>打开页面 <a target="_blank" rel="noopener" href="https://www.baidu.com/">https://www.baidu.com/</a></li>
<li>输入框输入搜索内容[霍格沃兹测试学院]</li>
<li>点击搜索按钮</li>
<li>找到结果并断言</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Generated by Selenium IDE</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_search</span>():</span><br><span class="line">    driver = webdriver.Chrome()</span><br><span class="line">    driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">    <span class="comment"># 打开页面：https:/www.baidu.com</span></span><br><span class="line">    driver.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">    <span class="comment"># 输入框输入搜索内容[霍格沃兹测试学院]</span></span><br><span class="line">    driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;#kw&quot;</span>).send_keys(<span class="string">&quot;霍格沃兹测试学院&quot;</span>)</span><br><span class="line">    <span class="comment"># 点击搜索按钮</span></span><br><span class="line">    driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;#su&quot;</span>).click()</span><br><span class="line">    <span class="comment"># 找到要查找的内容</span></span><br><span class="line">    result = driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;.result:nth-child(2)&gt;h3&gt;a&gt;em&quot;</span>).text</span><br><span class="line">    <span class="keyword">assert</span> <span class="string">&quot;霍格沃兹测试学院&quot;</span> <span class="keyword">in</span> result</span><br></pre></td></tr></table></figure>

<h1 id="4-Selenium三种等待方式"><a href="#4-Selenium三种等待方式" class="headerlink" title="4. Selenium三种等待方式"></a>4. Selenium三种等待方式</h1><h2 id="4-1-直接等待"><a href="#4-1-直接等待" class="headerlink" title="4.1 直接等待"></a>4.1 直接等待</h2><p>强制等待，线程休眠一定时间</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time.sleep(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h2 id="4-2-隐式等待"><a href="#4-2-隐式等待" class="headerlink" title="4.2 隐式等待"></a>4.2 隐式等待</h2><p>设置一个等待时间，轮询查找(默认0.5秒)元素是否出现，如果没出现就抛出<br>异常</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">self.driver.implicitly_wait(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<p>缺点：隐式等待是<strong>全局的设置</strong>，不一定能使每个操作都恰好合适</p>
<h2 id="4-3-显式等待"><a href="#4-3-显式等待" class="headerlink" title="4.3 显式等待"></a>4.3 显式等待</h2><ul>
<li>在代码中定义等待条件，当条件发生时才继续执行代码</li>
<li><code>WebDriverWait</code>配合<code>until()</code>和<code>until not()</code>方法，根据判断条件进行等待</li>
<li>程序每隔一段时间(默认为0.5秒)进行条件判断，如果条件成立，则执行下一步，否则继续等待，直到超过设置的最长时间</li>
</ul>
<p>例子：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.wait <span class="keyword">import</span> WebDriverWait</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestWait</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver = webdriver.Chrome()</span><br><span class="line">        self.driver.get(<span class="string">&quot;https://ceshiren.com/&quot;</span>)</span><br><span class="line">        self.driver.implicitly_wait(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_wait</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.find_element(By.ID, <span class="string">&#x27;ember33&#x27;</span>).click()</span><br><span class="line">        self.driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;[title~=&#x27;原创精华文章,有100元奖金&#x27;]&quot;</span>).click()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;hello&quot;</span>)</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        until(self, method, message=&#x27;&#x27;)</span></span><br><span class="line"><span class="string">        until方法需要传入一个method作为参数，method需要接受一个参数，所以wait_show也需要有一个参数</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># 方法1</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">wait_show</span>(<span class="params">x</span>):</span><br><span class="line">            <span class="comment"># 定位一组元素用find_elements，elements都是复数</span></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">len</span>(self.driver.find_elements(By.CSS_SELECTOR, <span class="string">&quot;[title~=&#x27;招聘内推&#x27;]&quot;</span>)) &gt;= <span class="number">1</span></span><br><span class="line">        WebDriverWait(self.driver, <span class="number">10</span>).until(wait_show)</span><br><span class="line">        <span class="comment"># 方法2</span></span><br><span class="line">        <span class="comment"># WebDriverWait(self.driver, 10).until(expected_conditions.element_to_be_clickable((By.CSS_SELECTOR, &quot;[title~=&#x27;招聘内推&#x27;]&quot;)))</span></span><br><span class="line">        self.driver.find_element(By.CSS_SELECTOR, <span class="string">&quot;[title~=&#x27;招聘内推&#x27;]&quot;</span>).click()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;WORLD&quot;</span>)</span><br></pre></td></tr></table></figure>



<h1 id="5-web控件定位与常见操作"><a href="#5-web控件定位与常见操作" class="headerlink" title="5. web控件定位与常见操作"></a>5. web控件定位与常见操作</h1><h2 id="5-1-Selenium的点击和输入"><a href="#5-1-Selenium的点击和输入" class="headerlink" title="5.1 Selenium的点击和输入"></a>5.1 Selenium的点击和输入</h2><p><strong>定义：</strong></p>
<ul>
<li><code>find_element(By.ID, &#39;su&#39;).click()</code></li>
<li><code>find_element(By.ID,&#39;kw&#39;).send_keys(&quot;霍格沃兹测试学院&quot;)</code></li>
</ul>
<h2 id="5-2-xpath"><a href="#5-2-xpath" class="headerlink" title="5.2 xpath"></a>5.2 xpath</h2><h3 id="1-定义"><a href="#1-定义" class="headerlink" title="(1) 定义"></a>(1) 定义</h3><ul>
<li>解析XML的一种语言(HTML其实是XML的子级)，<strong>广泛用于解析HTML数据</strong></li>
<li>几乎所有语言都能使用XPath，比如Java和C语言</li>
<li>除了XPathi还有其他手段用于XML解析，比如：BeautifulSoup、Ixml、D0M、SAX、JSD0M、D0M4J、minixml等</li>
</ul>
<blockquote>
<p><code>xpath</code>既可以用于appium，也可以用于selenium。不过缺点是比<code>CSS.SELECTOR</code>要慢。因为<code>xpath</code>是从头到尾去遍历的。</p>
</blockquote>
<h3 id="2-XPath语法"><a href="#2-XPath语法" class="headerlink" title="(2)XPath语法"></a>(2)XPath语法</h3><p>XPath语法其实只有三大类：</p>
<ul>
<li>层级：<code>/</code>直接子级、<code>//</code>跳级(多少级都可以)</li>
<li>属性：<code>@</code>属性访问</li>
<li>函数：<code>contains()</code>、<code>text()</code>等</li>
</ul>
<h4 id="表达式"><a href="#表达式" class="headerlink" title="表达式"></a>表达式</h4><table>
<thead>
<tr>
<th align="left">表达式</th>
<th align="left">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="left">nodename</td>
<td align="left">选取此节点的所有子节点。</td>
</tr>
<tr>
<td align="left">&#x2F;</td>
<td align="left">从根节点选取(取子节点)。</td>
</tr>
<tr>
<td align="left">&#x2F;&#x2F;</td>
<td align="left">从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置(取子孙节点)。</td>
</tr>
<tr>
<td align="left">.</td>
<td align="left">选取当前节点。</td>
</tr>
<tr>
<td align="left">..</td>
<td align="left">选取当前节点的父节点。</td>
</tr>
<tr>
<td align="left">@</td>
<td align="left">选取属性。</td>
</tr>
</tbody></table>
<h4 id="谓语-条件"><a href="#谓语-条件" class="headerlink" title="谓语(条件)"></a>谓语(条件)</h4><p>谓语用来查找某个特定的节点或者包含某个指定的值的节点。</p>
<p>谓语被嵌在方括号<font color="red"><code>[]</code></font>中。</p>
<p>在下面的表格中，我们列出了带有谓语的一些路径表达式，以及表达式的结果：</p>
<table>
<thead>
<tr>
<th>路径表达式</th>
<th>结果</th>
</tr>
</thead>
<tbody><tr>
<td><code>/bookstore/book[1]</code></td>
<td>选取属于bookstore子元素的第一个book元素。</td>
</tr>
<tr>
<td><code>/bookstore/book[last()]</code></td>
<td>选取属于bookstore子元素的最后一个book元素。</td>
</tr>
<tr>
<td><code>/bookstore/book[last()-1]</code></td>
<td>选取属于bookstore子元素的倒数第二个book元素。</td>
</tr>
<tr>
<td><code>/bookstore/book[position(&lt;3]</code></td>
<td>选取最前面的两个属于bookstore元素的子元素的book元素。</td>
</tr>
<tr>
<td><code>//title[@lang=&#39;eng&#39;]</code></td>
<td>选取所有title元素，且这些元素拥有值为eng的lang属性。</td>
</tr>
<tr>
<td><code>/bookstore/book[price&gt;35.00]</code></td>
<td>选取bookstore元素的所有book元素， 且其中的price元素的值须大于35.00.</td>
</tr>
<tr>
<td><code>/bookstore/book[price&gt;35.00]/title</code></td>
<td>选取bookstore元素中的book元素的所有title元素， 且其中的price元素的值须大于35.00。</td>
</tr>
</tbody></table>
<h2 id="5-3-Css-Selector"><a href="#5-3-Css-Selector" class="headerlink" title="5.3 Css Selector"></a>5.3 Css Selector</h2><blockquote>
<p><code>css selector</code>既可以用于appium，也可以用于selenium。不过appium原生控件不支持css selector，当对手机中的网页定位，才可以用css selector。</p>
</blockquote>
<h3 id="1-id选择器-身份选择器"><a href="#1-id选择器-身份选择器" class="headerlink" title="1. id选择器 身份选择器"></a>1. id选择器 身份选择器</h3><p>作用：选取带有id属性，并且id属性值为id-name的标签。</p>
<blockquote>
<p>id是唯一的，所以一个id只能可以套用到一个HTML元素上，而一个HTML元素也只能拥有一个id。</p>
<p>命名规则：id选择器的名称除了第一个字符必须为英文字母以外，后续字符可以是大小写字母和-或者_</p>
<p>id选择器需要以 <code>#</code>开头 — <code>#id</code></p>
</blockquote>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401104833012.png" alt="image-20220401104833012"></p>
<h3 id="2-class选择器-类选择器"><a href="#2-class选择器-类选择器" class="headerlink" title="2. class选择器 类选择器"></a>2. class选择器 类选择器</h3><p>作用：选取所有带有class属性，并且id属性值为id-name的标签。</p>
<blockquote>
<p>class选择器可以用于多个元素，因为他不是唯一的。</p>
<p>与id选择器不同的是，一个class可以套用到多个HTML元素上，而一个HTML元素也可以拥有多个class。</p>
<p>class选择器需要以 <code>.</code>开头 — <code>.class</code></p>
</blockquote>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401110134896.png" alt="image-20220401110134896"></p>
<h3 id="3-tag选择器-标签选择器"><a href="#3-tag选择器-标签选择器" class="headerlink" title="3. tag选择器 标签选择器"></a>3. tag选择器 标签选择器</h3><p>作用：选取所有tag标签。</p>
<blockquote>
<p>在css中直接使用HTML标签(Tag)的名称，例如<h>、<p>、<div>等等。这种方式会将样式套用到所有对应的标签中。</div></p>
<p>如果在Tag名称后加上id选取器或class选取器，如div.bg{}，就代表bg这个class只能用于div上，用于别HTML的标签则不会生效。</p>
</h></p></blockquote>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401132554549.png" alt="image-20220401132554549"></p>
<h3 id="4-空格"><a href="#4-空格" class="headerlink" title="4. 空格"></a>4. 空格</h3><p>作用：选取并修饰该A标签内的所有子A标签，不包括该标签本身。</p>
<blockquote>
<p>比如：<code>.contain div</code>，即是选取拥有contain这个class的HTML元素里面的所有div。</p>
<p><em>但是并不包括contain本身。</em></p>
</blockquote>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401134502450.png" alt="image-20220401134502450"></p>
<h3 id="5-gt-大于号"><a href="#5-gt-大于号" class="headerlink" title="5. &gt; 大于号"></a>5. &gt; 大于号</h3><p>作用：选取该A标签内的所有第一层子A标签，不包括该标签本身。</p>
<blockquote>
<p>比如：<code>.contain&gt;div</code>，即是选取拥有containe这个class的HTML元素里面第一层的所有div。</p>
</blockquote>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401140209612.png" alt="image-20220401140209612"></p>
<h3 id="6-加号"><a href="#6-加号" class="headerlink" title="6. + 加号"></a>6. + 加号</h3><p>作用：选取所有某种标签下的第一个子标签元素。</p>
<blockquote>
<p>比如：<code>.contain+div</code>，意思是选取拥有contain这个class的HTML元素与它身处同一层紧接着的div。</p>
<p><em>注意如果紧接着的并不是div，就不会选取到任何东西。</em></p>
</blockquote>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401141033393.png" alt="image-20220401141033393"></p>
<h3 id="7-波浪线"><a href="#7-波浪线" class="headerlink" title="7. ~ 波浪线"></a>7. ~ 波浪线</h3><p>作用：选取所有某种元素之后所有同一层的所有某种元素</p>
<blockquote>
<p>比如：<code>.contain ~ div</code>，意思是选取拥有contain这个class的HTML元素与它身处同一层之后的所有div。</p>
<p>尽管其中有其他HTML元素隔开，只要是与contain处于同一层都会套用得到。</p>
</blockquote>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401141544857.png" alt="image-20220401141544857"></p>
<h3 id="8-星号"><a href="#8-星号" class="headerlink" title="8. * 星号"></a>8. * 星号</h3><p>作用：代替具体的条件，表示所有。</p>
<blockquote>
<p>如果只用一个星号的话即是选取所有HTML元素。</p>
</blockquote>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401142008458.png" alt="image-20220401142008458"></p>
<blockquote>
<p>比如：<code>.contain ~ *</code>，会将contain class套用到contain之后的所有标签。</p>
</blockquote>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401143236014.png" alt="image-20220401143236014"></p>
<h3 id="9-属性选择器-attribute"><a href="#9-属性选择器-attribute" class="headerlink" title="9. 属性选择器 attribute"></a>9. 属性选择器 attribute</h3><p>作用：是透过HTML元素的属性去选取。<code>[attribute=value]</code></p>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401143839958.png" alt="image-20220401143839958"></p>
<p>还可以通过一些正则表达式去选取：</p>
<blockquote>
<p>比如<code>^=</code>：选取匹配行首的元素</p>
<p><code>$=</code>：选取匹配行尾的元素</p>
</blockquote>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401145218205.png" alt="image-20220401145218205"></p>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401145302501.png" alt="image-20220401145302501"></p>
<blockquote>
<p><code>*=</code>则为包含关键词，无论头尾。</p>
</blockquote>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401145924333.png" alt="image-20220401145924333"></p>
<h3 id="10-伪类-pseudo-class"><a href="#10-伪类-pseudo-class" class="headerlink" title="10. 伪类 pseudo class"></a>10. 伪类 pseudo class</h3><p>作用：用于选择一般选择器无法表达的选择方式。</p>
<blockquote>
<p>写法格式：以上九种形式加冒号加条件。</p>
</blockquote>
<p><code>a: hover&#123;color:red&#125;</code> ：鼠标悬停变红<br><code>a: visited&#123;color:cyan&#125;</code> ：点击过该链接则为天蓝色</p>
<p><code>div:nth-child(3n + 0)&#123;background: pink;&#125;</code>：div的子元素中3的倍数的元素，底色变为粉色</p>
<blockquote>
<p>nth-chile()参数特别的有：odd(奇数)、even(双数)、3n+0(选取3倍数)、2n效果even 一样。</p>
</blockquote>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220401161757286.png" alt="image-20220401161757286"></p>
<h3 id="详细实例："><a href="#详细实例：" class="headerlink" title="详细实例："></a>详细实例：</h3><table>
<thead>
<tr>
<th align="left">选择器</th>
<th align="left">示例</th>
<th align="left">示例说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-class.html">.<em>class</em></a></td>
<td align="left">.intro</td>
<td align="left">选择所有class&#x3D;”intro”的元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-id.html">#<em>id</em></a></td>
<td align="left">#firstname</td>
<td align="left">选择所有id&#x3D;”firstname”的元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-all.html">*</a></td>
<td align="left">*</td>
<td align="left">选择所有元素</td>
</tr>
<tr>
<td align="left"><em><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-element.html">element</a></em></td>
<td align="left">p</td>
<td align="left">选择所有<p>元素</p></td>
</tr>
<tr>
<td align="left"><em><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-element-comma.html">element,element</a></em></td>
<td align="left">div,p</td>
<td align="left">选择所有<div>元素和<p>元素</p></div></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-element-element.html"><em>element</em> <em>element</em></a></td>
<td align="left">div p</td>
<td align="left">选择<div>元素内的所有<p>元素</p></div></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-element-gt.html"><em>element</em>&gt;<em>element</em></a></td>
<td align="left">div&gt;p</td>
<td align="left">选择所有父级是 <div> 元素的 <p> 元素</p></div></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-element-pluss.html"><em>element</em>+<em>element</em></a></td>
<td align="left">div+p</td>
<td align="left">选择所有紧跟在 <div> 元素之后的第一个 <p> 元素</p></div></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-attribute.html">[<em>attribute</em>]</a></td>
<td align="left">[target]</td>
<td align="left">选择所有带有target属性元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-attribute-value.html">[<em>attribute</em>&#x3D;<em>value</em>]</a></td>
<td align="left">[target&#x3D;-blank]</td>
<td align="left">选择所有使用target&#x3D;”-blank”的元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-attribute-value-contains.html">[<em>attribute</em>~&#x3D;<em>value</em>]</a></td>
<td align="left">[title~&#x3D;flower]</td>
<td align="left">选择标题属性包含单词”flower”的所有元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-attribute-value-lang.html">[<em>attribute</em>|&#x3D;<em>language</em>]</a></td>
<td align="left">[lang|&#x3D;en]</td>
<td align="left">选择 lang 属性等于 <strong>en</strong>，或者以 <strong>en-</strong> 为开头的所有元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-link.html">:link</a></td>
<td align="left">a:link</td>
<td align="left">选择所有未访问链接</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-visited.html">:visited</a></td>
<td align="left">a:visited</td>
<td align="left">选择所有访问过的链接</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-active.html">:active</a></td>
<td align="left">a:active</td>
<td align="left">选择活动链接</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-hover.html">:hover</a></td>
<td align="left">a:hover</td>
<td align="left">选择鼠标在链接上面时</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-focus.html">:focus</a></td>
<td align="left">input:focus</td>
<td align="left">选择具有焦点的输入元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-firstletter.html">:first-letter</a></td>
<td align="left">p:first-letter</td>
<td align="left">选择每一个<p>元素的第一个字母</p></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-firstline.html">:first-line</a></td>
<td align="left">p:first-line</td>
<td align="left">选择每一个<p>元素的第一行</p></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-firstchild.html">:first-child</a></td>
<td align="left">p:first-child</td>
<td align="left">指定只有当<p>元素是其父级的第一个子级的样式。</p></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-before.html">:before</a></td>
<td align="left">p:before</td>
<td align="left">在每个<p>元素之前插入内容</p></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-after.html">:after</a></td>
<td align="left">p:after</td>
<td align="left">在每个<p>元素之后插入内容</p></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-lang.html">:lang(<em>language</em>)</a></td>
<td align="left">p:lang(it)</td>
<td align="left">选择一个lang属性的起始值&#x3D;”it”的所有<p>元素</p></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-gen-sibling.html"><em>element1</em>~<em>element2</em></a></td>
<td align="left">p~ul</td>
<td align="left">选择p元素之后的每一个ul元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-attr-begin.html">[<em>attribute</em>^&#x3D;<em>value</em>]</a></td>
<td align="left">a[src^&#x3D;”https”]</td>
<td align="left">选择每一个src属性的值以”https”开头的元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-attr-end.html">[<em>attribute</em>$&#x3D;<em>value</em>]</a></td>
<td align="left">a[src$&#x3D;”.pdf”]</td>
<td align="left">选择每一个src属性的值以”.pdf”结尾的元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-attr-contain.html">[<em>attribute</em>*&#x3D;<em>value</em>]</a></td>
<td align="left">a[src*&#x3D;”runoob”]</td>
<td align="left">选择每一个src属性的值包含子字符串”runoob”的元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-first-of-type.html">:first-of-type</a></td>
<td align="left">p:first-of-type</td>
<td align="left">选择每个p元素是其父级的第一个p元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-last-of-type.html">:last-of-type</a></td>
<td align="left">p:last-of-type</td>
<td align="left">选择每个p元素是其父级的最后一个p元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-only-of-type.html">:only-of-type</a></td>
<td align="left">p:only-of-type</td>
<td align="left">选择每个p元素是其父级的唯一p元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-only-child.html">:only-child</a></td>
<td align="left">p:only-child</td>
<td align="left">选择每个p元素是其父级的唯一子元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-nth-child.html">:nth-child(<em>n</em>)</a></td>
<td align="left">p:nth-child(2)</td>
<td align="left">选择每个p元素是其父级的第二个子元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-nth-last-child.html">:nth-last-child(<em>n</em>)</a></td>
<td align="left">p:nth-last-child(2)</td>
<td align="left">选择每个p元素的是其父级的第二个子元素，从最后一个子项计数</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-nth-of-type.html">:nth-of-type(<em>n</em>)</a></td>
<td align="left">p:nth-of-type(2)</td>
<td align="left">选择每个p元素是其父级的第二个p元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-nth-last-of-type.html">:nth-last-of-type(<em>n</em>)</a></td>
<td align="left">p:nth-last-of-type(2)</td>
<td align="left">选择每个p元素的是其父级的第二个p元素，从最后一个子项计数</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-last-child.html">:last-child</a></td>
<td align="left">p:last-child</td>
<td align="left">选择每个p元素是其父级的最后一个子级。</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-root.html">:root</a></td>
<td align="left">:root</td>
<td align="left">选择文档的根元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-empty.html">:empty</a></td>
<td align="left">p:empty</td>
<td align="left">选择每个没有任何子级的p元素(包括文本节点)</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-target.html">:target</a></td>
<td align="left">#news:target</td>
<td align="left">选择当前活动的#news元素(包含该锚名称的点击的URL)</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-enabled.html">:enabled</a></td>
<td align="left">input:enabled</td>
<td align="left">选择每一个已启用的输入元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-disabled.html">:disabled</a></td>
<td align="left">input:disabled</td>
<td align="left">选择每一个禁用的输入元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-checked.html">:checked</a></td>
<td align="left">input:checked</td>
<td align="left">选择每个选中的输入元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-not.html">:not(<em>selector</em>)</a></td>
<td align="left">:not(p)</td>
<td align="left">选择每个并非p元素的元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-selection.html">::selection</a></td>
<td align="left">::selection</td>
<td align="left">匹配元素中被用户选中或处于高亮状态的部分</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-out-of-range.html">:out-of-range</a></td>
<td align="left">:out-of-range</td>
<td align="left">匹配值在指定区间之外的input元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-in-range.html">:in-range</a></td>
<td align="left">:in-range</td>
<td align="left">匹配值在指定区间之内的input元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-read-write.html">:read-write</a></td>
<td align="left">:read-write</td>
<td align="left">用于匹配可读及可写的元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-read-only.html">:read-only</a></td>
<td align="left">:read-only</td>
<td align="left">用于匹配设置 “readonly”(只读) 属性的元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-optional.html">:optional</a></td>
<td align="left">:optional</td>
<td align="left">用于匹配可选的输入元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-required.html">:required</a></td>
<td align="left">:required</td>
<td align="left">用于匹配设置了 “required” 属性的元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-valid.html">:valid</a></td>
<td align="left">:valid</td>
<td align="left">用于匹配输入值为合法的元素</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://www.runoob.com/cssref/sel-invalid.html">:invalid</a></td>
<td align="left">:invalid</td>
<td align="left">用于匹配输入值为非法的元素</td>
</tr>
</tbody></table>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestGet</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver = webdriver.Chrome()</span><br><span class="line">        self.driver.get(<span class="string">&quot;https://www.baidu.com/&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># def test_get_xpath(self):</span></span><br><span class="line">    <span class="comment">#     self.driver.find_element(By.XPATH, &#x27;//input[@id=&quot;kw&quot;]&#x27;).send_keys(&quot;霍格沃兹测试学院&quot;)</span></span><br><span class="line">    <span class="comment">#     print(&#x27;测试输入&#x27;)</span></span><br><span class="line">    <span class="comment">#     self.driver.find_element(By.XPATH, &#x27;//input[@id=&quot;su&quot;]&#x27;).click()</span></span><br><span class="line">    <span class="comment">#     print(&#x27;测试搜索&#x27;)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_css_selector</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#kw&#x27;</span>).send_keys(<span class="string">&quot;霍格沃兹测试学院&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;test print&#x27;</span>)</span><br><span class="line">        self.driver.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#su&#x27;</span>).click()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;test search&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="6-web控件的交互进阶"><a href="#6-web控件的交互进阶" class="headerlink" title="6. web控件的交互进阶"></a>6. web控件的交互进阶</h1><p>常用的操作事件(右键点击，页面滑动，表单操作等)。</p>
<p>官方文档<br><a target="_blank" rel="noopener" href="https://selenium-python.readthedocs.io/api.html">https://selenium-python.readthedocs.io/api.html</a> </p>
<ul>
<li>ActionChains：执行PC端的鼠标点击，双击，右键，拖搜等事件</li>
<li>TouchActions：模拟PC和移动端的点击，滑动，拖拽，多点触控等多种手势操作</li>
</ul>
<h2 id="6-1-ActionChains-动作链接"><a href="#6-1-ActionChains-动作链接" class="headerlink" title="6.1 ActionChains 动作链接"></a>6.1 ActionChains 动作链接</h2><p>执行原理：调用ActionChains的方法时，<font color="red">不会立即执行</font>，而是将所有的操作，按顺序存放在一个队列里，当你调用<code>perform()</code>方法时，队列中的事件会依次执行。</p>
<h3 id="6-1-1-基本用法"><a href="#6-1-1-基本用法" class="headerlink" title="6.1.1 基本用法"></a>6.1.1 基本用法</h3><ul>
<li>生成一个动作<code>action= ActionChains(driver)</code></li>
<li>动作添加方法1 <code>action.方法1</code></li>
<li>动作添加方法2 <code>action.方法2</code></li>
<li>调用<code>perform()</code>方法执行<code>(action.perform())</code></li>
</ul>
<h3 id="6-1-2-具体写法"><a href="#6-1-2-具体写法" class="headerlink" title="6.1.2 具体写法"></a>6.1.2 具体写法</h3><ul>
<li>链式写法<ul>
<li><code>ActionChains(driver).move_to_element(element).click(element).perform()</code></li>
</ul>
</li>
<li>分布写法<ul>
<li><code>actions = ActionChains(driver)</code></li>
<li><code>actions.move_to_element(element)</code></li>
<li><code>actions.click(element)</code></li>
<li><code>actions.perform()</code></li>
</ul>
</li>
</ul>
<h3 id="6-1-3-ActionChains-用法1"><a href="#6-1-3-ActionChains-用法1" class="headerlink" title="6.1.3 ActionChains 用法1"></a>6.1.3 ActionChains 用法1</h3><p>用法一：点击，右键，双击操作</p>
<ul>
<li><code>action = ActionChains(driver)</code></li>
<li><code>action.click(element)</code></li>
<li><code>action.double_click(element)</code></li>
<li><code>action.context_click(element)</code></li>
<li><code>action.perform()</code></li>
</ul>
<p>测试案例</p>
<ul>
<li>打开页面(<a target="_blank" rel="noopener" href="http://sahitest.com/demo/clicks.htm">http://sahitest.com/demo/clicks.htm</a>)</li>
<li>分别对按钮’click me’，’dbl click me’， right click me’，执行点击，双击，右键操作</li>
<li>打印上面展示框中的内容</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestActionChains</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver = webdriver.Chrome()</span><br><span class="line">        self.driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">teardown</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.quit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_click</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.get(<span class="string">&quot;http://sahitest.com/demo/clicks.htm&quot;</span>)</span><br><span class="line">        element_click = self.driver.find_element(By.XPATH, <span class="string">&quot;/html/body/form/input[3]&quot;</span>)</span><br><span class="line">        element_dblclick = self.driver.find_element(By.XPATH, <span class="string">&quot;/html/body/form/input[2]&quot;</span>)</span><br><span class="line">        element_right_click = self.driver.find_element(By.XPATH, <span class="string">&quot;/html/body/form/input[4]&quot;</span>)</span><br><span class="line">        action = ActionChains(self.driver)</span><br><span class="line">        action.click(element_click)</span><br><span class="line">        action.context_click(element_right_click)</span><br><span class="line">        action.double_click(element_dblclick)</span><br><span class="line">        sleep(<span class="number">3</span>)</span><br><span class="line">        action.perform()</span><br><span class="line">        sleep(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h3 id="6-1-4-ActionChains-用法2"><a href="#6-1-4-ActionChains-用法2" class="headerlink" title="6.1.4 ActionChains 用法2"></a>6.1.4 ActionChains 用法2</h3><p>用法二：鼠标移动到某个元素上</p>
<ul>
<li><code>action = ActionChains(self.driver)</code></li>
<li><code>action.move_to_element(element)</code></li>
<li><code>action.perform()</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test_move_to_element</span>(<span class="params">self</span>):</span><br><span class="line">    self.driver.get(<span class="string">&quot;https://www.baidu.com/?tn=44004473_13_oem_dg&quot;</span>)</span><br><span class="line">    move_to_element = self.driver.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;s-usersetting-top&quot;]&#x27;</span>)</span><br><span class="line">    action = ActionChains(self.driver)</span><br><span class="line">    action.move_to_element(move_to_element)</span><br><span class="line">    action.perform()</span><br></pre></td></tr></table></figure>

<h3 id="6-1-5-ActionChains-用法3"><a href="#6-1-5-ActionChains-用法3" class="headerlink" title="6.1.5 ActionChains 用法3"></a>6.1.5 ActionChains 用法3</h3><p>用法三：鼠标拖拽某个元素到另一元素上</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test_dragdrop</span>(<span class="params">self</span>):</span><br><span class="line">    self.driver.get(<span class="string">&quot;http://sahitest.com/demo/dragDropMooTools.htm&quot;</span>)</span><br><span class="line">    drag_element = self.driver.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;dragger&quot;]&#x27;</span>)</span><br><span class="line">    drop_element = self.driver.find_element(By.XPATH, <span class="string">&#x27;/html/body/div[2]&#x27;</span>)</span><br><span class="line">    action = ActionChains(self.driver)</span><br><span class="line">    <span class="comment"># 方法1</span></span><br><span class="line">    <span class="comment"># action.drag_and_drop(drag_element, drop_element)</span></span><br><span class="line">    <span class="comment"># 方法2</span></span><br><span class="line">    <span class="comment"># action.click_and_hold(drag_element).release(drop_element)</span></span><br><span class="line">    <span class="comment"># 方法3</span></span><br><span class="line">    action.click_and_hold(drag_element).move_to_element(drop_element).release()</span><br><span class="line">    action.perform()</span><br></pre></td></tr></table></figure>

<h3 id="6-1-6-ActionChains-用法4"><a href="#6-1-6-ActionChains-用法4" class="headerlink" title="6.1.6 ActionChains 用法4"></a>6.1.6 ActionChains 用法4</h3><p>用法四：ActionChains模拟按键方法</p>
<p>模拟按键有多种方法，能用win32api来实现，能用SendKeys来实现，也可以用selenium的WebElement对象的send_keys()方法来实现，这里ActionChains类也提供了几个模拟按键的方法。</p>
<p>用法：</p>
<ul>
<li><code>Action = ActionChains(driver)</code></li>
<li><code>action.send_keys(Keys.BACK_SPACE)</code></li>
<li>或者<code>action.key_down(Keys.CONTROL).send_keys(&#39;a&#39;).key_up(Keys.CONTROL)</code></li>
<li><code>action.perform()</code></li>
</ul>
<p>打开网址：<a target="_blank" rel="noopener" href="http://sahitest.com/demo/label.htm">http://sahitest.com/demo/label.htm</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test_key</span>(<span class="params">self</span>):</span><br><span class="line">    self.driver.get(<span class="string">&quot;http://sahitest.com/demo/label.htm&quot;</span>)</span><br><span class="line">    element = self.driver.find_element(By.XPATH, <span class="string">&quot;/html/body/label[1]/input&quot;</span>)</span><br><span class="line">    element.click()</span><br><span class="line">    action = ActionChains(self.driver)</span><br><span class="line">    action.send_keys(<span class="string">&quot;username&quot;</span>).pause(<span class="number">1</span>)</span><br><span class="line">    action.send_keys(Keys.SPACE).pause(<span class="number">1</span>)</span><br><span class="line">    action.send_keys(<span class="string">&quot;tom&quot;</span>).pause(<span class="number">1</span>)</span><br><span class="line">    action.send_keys(Keys.BACK_SPACE).perform()</span><br><span class="line">    sleep(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h2 id="6-2-TouchActions"><a href="#6-2-TouchActions" class="headerlink" title="6.2 TouchActions"></a>6.2 TouchActions</h2><p>官网：<a target="_blank" rel="noopener" href="https://www.selenium.dev/selenium/docs/api/py/webdriver/selenium.webdriver.common.touch_actions.html">https://www.selenium.dev/selenium/docs/api/py/webdriver/selenium.webdriver.common.touch_actions.html</a></p>
<p>类似于ActionChains。ActionChains只是针对PC端程序鼠标模拟的一系列操作，对H5页面操作是无效的，TouchAction可以对h5页面操作，通过TouchAction可以实现点击，滑动。拖拽，多点触控，以及模拟手势的各种操作。</p>
<p>手势控制</p>
<ul>
<li>tap：在指定元素上敲击</li>
<li>double_tap：在指定元素上双敲击</li>
<li>tap_and_hold：在指定元素上点击但不释放</li>
<li>move：手势移动指定偏移（未释放）</li>
<li>release：释放手势</li>
<li>scroll：手势点击并滚动</li>
<li>scroll_from_element：从某个元素位置开始手势点击并滚动（向下滑动为负数，向上滑动为正数）</li>
<li>long_press：长按元素</li>
<li>flick：手势滑动</li>
<li>flick_element：从某个元素位置开始手势滑动（向上滑动为负数，向下滑动为正数）</li>
<li>Perform：执行</li>
</ul>
<h3 id="6-2-1-TouchActions实例"><a href="#6-2-1-TouchActions实例" class="headerlink" title="6.2.1 TouchActions实例"></a>6.2.1 TouchActions实例</h3><ul>
<li>打开Chrome</li>
<li>打开URL：<a target="_blank" rel="noopener" href="http://www.baidu.com/">http://www.baidu.com</a></li>
<li>向搜索框中输入“selenium测试”</li>
<li>通过TouchAction点击搜索框</li>
<li>滑动到底部，点击下一页</li>
<li>关闭Chrome</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TestTouchAction</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 在创建 driver 对象时，添加浏览器的 option 选项 关闭 w3c 模式</span></span><br><span class="line">        option = webdriver.ChromeOptions()</span><br><span class="line">        option.add_experimental_option(<span class="string">&#x27;w3c&#x27;</span>, <span class="literal">False</span>)</span><br><span class="line">        self.driver = webdriver.Chrome(options=option)</span><br><span class="line">        self.driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">teardown</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.quit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_touch_actions</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.get(<span class="string">&quot;http://www.baidu.com&quot;</span>)</span><br><span class="line">        input_element = self.driver.find_element_by_id(<span class="string">&quot;kw&quot;</span>)</span><br><span class="line">        input_element.send_keys(<span class="string">&quot;selenium测试&quot;</span>)</span><br><span class="line">        search_element = self.driver.find_element_by_id(<span class="string">&quot;su&quot;</span>)</span><br><span class="line">        action = TouchActions(self.driver)</span><br><span class="line">        action.tap(search_element)</span><br><span class="line"></span><br><span class="line">        action.scroll_from_element(search_element, <span class="number">0</span>, <span class="number">10000</span>)</span><br><span class="line">        action.perform()</span><br><span class="line">        sleep(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h2 id="6-3-表单操作"><a href="#6-3-表单操作" class="headerlink" title="6.3 表单操作"></a>6.3 表单操作</h2><ul>
<li>什么是表单？<ul>
<li>表单是一个包含表单元素的区域。</li>
<li>表单元素是允许用户在表单中（比如：文本域、下拉列表、单选框、复选框等等）输入信息的元素。</li>
<li>表单使用表单标签（<form>）定义。例如：<form><input></form></form></li>
</ul>
</li>
<li>操作表单元素步骤：<ul>
<li>首先要定位到表单元素</li>
<li>然后去操作元素（清空，输入或者点击等）</li>
</ul>
</li>
</ul>
<h3 id="6-3-1-提交表单实例"><a href="#6-3-1-提交表单实例" class="headerlink" title="6.3.1 提交表单实例"></a>6.3.1 提交表单实例</h3><p>测试用例步骤：</p>
<ol>
<li>打开testerhome登录地址：<a target="_blank" rel="noopener" href="https://testerhome.com/account/sign_in">https://testerhome.com/account/sign_in</a></li>
<li>输入用户名</li>
<li>输入密码</li>
<li>点击记住标签</li>
<li>点击登录，提交表单</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TestForm</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver = webdriver.Chrome()</span><br><span class="line">        self.driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">teardown</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.quit()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_form</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.get(<span class="string">&quot;https://testerhome.com/account/sign_in&quot;</span>)</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">&quot;user_login&quot;</span>).send_keys(<span class="string">&quot;123&quot;</span>)</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">&quot;user_password&quot;</span>).send_keys(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">        self.driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;new_user&quot;]/div[3]/div/label&#x27;</span>).click()</span><br><span class="line">        self.driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;new_user&quot;]/div[4]/input&#x27;</span>)</span><br><span class="line">        sleep(<span class="number">5</span>)</span><br></pre></td></tr></table></figure>

<h1 id="7-多窗口处理与网页frame"><a href="#7-多窗口处理与网页frame" class="headerlink" title="7. 多窗口处理与网页frame"></a>7. 多窗口处理与网页frame</h1><h2 id="7-1-selenium里面如何处理多窗口场景"><a href="#7-1-selenium里面如何处理多窗口场景" class="headerlink" title="7.1 selenium里面如何处理多窗口场景"></a>7.1 selenium里面如何处理多窗口场景</h2><ul>
<li><p>点击某些链接，会重新打开一个窗口，对于这种情况，想在新页面上操作，就</p>
<p>  得先切换窗口了。</p>
</li>
<li><p>获取窗口的唯一标识用句柄表示，所以只需要切换句柄，就可以在多个页面灵</p>
<p>  活操作了。</p>
</li>
</ul>
<h2 id="7-2-多个窗口识别"><a href="#7-2-多个窗口识别" class="headerlink" title="7.2 多个窗口识别"></a>7.2 多个窗口识别</h2><ul>
<li>获取到当前的窗口句柄（<code>driver.current_window_handle</code>）</li>
<li>获取到所有的窗口句柄（<code>driver.window_handles</code>）</li>
</ul>
<h2 id="7-3-多个窗口之间切换"><a href="#7-3-多个窗口之间切换" class="headerlink" title="7.3 多个窗口之间切换"></a>7.3 多个窗口之间切换</h2><ul>
<li>判断是否是想要操作的窗口，如果是，就可以对窗口进行操作，如果不是，跳转到另外一个窗口，对另一个窗口进行操作（<code>driver.switch_to_window</code>）</li>
</ul>
<p><strong>多窗口切换案例</strong>：</p>
<ol>
<li>打开百度页面</li>
<li>点击登录，弹框中点击立即注册，输入用户名和帐号</li>
<li>返回刚才的登录页，点击登录</li>
<li>输入用户名和密码，点击登录</li>
</ol>
<p>test_base.py：将setup&#x2F;teardown方法进行封装</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver = webdriver.Chrome()</span><br><span class="line">        self.driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">        self.driver.maximize_window()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">teardown</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.quit()</span><br></pre></td></tr></table></figure>

<p>test_window.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TestWindow</span>(<span class="title class_ inherited__">Base</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_Window</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.get(<span class="string">&quot;https://www.baidu.com/&quot;</span>)</span><br><span class="line">        self.driver.find_element_by_link_text(<span class="string">&quot;登录&quot;</span>).click()</span><br><span class="line">        self.driver.find_element_by_link_text(<span class="string">&quot;立即注册&quot;</span>).click()</span><br><span class="line">        <span class="built_in">print</span>(self.driver.window_handles)</span><br><span class="line">        <span class="comment"># 所有的窗口输出是个列表</span></span><br><span class="line">        windows = self.driver.window_handles</span><br><span class="line">        self.driver.switch_to_window(windows[-<span class="number">1</span>])</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">&quot;TANGRAM__PSP_4__userName&quot;</span>).send_keys(<span class="string">&quot;123&quot;</span>)</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">&quot;TANGRAM__PSP_4__phone&quot;</span>).send_keys(<span class="string">&quot;13800000000&quot;</span>)</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">&quot;TANGRAM__PSP_4__password&quot;</span>).send_keys(<span class="string">&quot;123&quot;</span>)</span><br><span class="line">        sleep(<span class="number">3</span>)</span><br><span class="line">        self.driver.switch_to_window(windows[<span class="number">0</span>])</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">&quot;TANGRAM__PSP_11__userName&quot;</span>).send_keys(<span class="string">&quot;13800000000&quot;</span>)</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">&quot;TANGRAM__PSP_11__password&quot;</span>).send_keys(<span class="string">&quot;123&quot;</span>)</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">&quot;TANGRAM__PSP_11__submit&quot;</span>).click()</span><br><span class="line">        sleep(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<h2 id="7-4-selenium里面如何处理frame"><a href="#7-4-selenium里面如何处理frame" class="headerlink" title="7.4 selenium里面如何处理frame"></a>7.4 selenium里面如何处理frame</h2><p><strong>frame</strong>介绍</p>
<ul>
<li><p>在web自动化中，如果一个元素定位不到，那么很大可能是在<code>iframe</code>中。</p>
</li>
<li><p>什么是frame？</p>
<ul>
<li>frame是html中的框架，在html中，所谓的框架就是可以在同一个浏览器中显示不止一个页面。</li>
<li>基于html的框架，又分为垂直框架和水平框架（<code>cols,rows</code>）</li>
</ul>
</li>
<li><p>Frame分类</p>
<ul>
<li>frame标签包含frameset、frame、iframe三种。</li>
<li>frameset和普通的标签一样，不会影响正常的定位，可以使用index、id、name、webelement 任意种方式定位frame。</li>
<li>而frame与iframe对selenium定位而言是一样的。selenium有一组方法对frame进行操作。</li>
</ul>
</li>
<li><p>演示：<a target="_blank" rel="noopener" href="https://www.w3school.com.cn/tiy/t.asp?f=html_frame_cols">https://www.w3school.com.cn/tiy/t.asp?f=html_frame_cols</a></p>
<p>  <img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220406135402787.png" alt="image-20220406135402787"></p>
</li>
</ul>
<h2 id="7-5-多个frame识别"><a href="#7-5-多个frame识别" class="headerlink" title="7.5 多个frame识别"></a>7.5 多个frame识别</h2><h2 id="7-6-多个frame之间切换"><a href="#7-6-多个frame之间切换" class="headerlink" title="7.6 多个frame之间切换"></a>7.6 多个frame之间切换</h2><ul>
<li><p>frame存在两种：</p>
<ul>
<li><p>一种是嵌套的</p>
<ul>
<li>对于嵌套的先进入到frame的父节点，再进到子节点，然后可以对子节点里面的对象进行处理和操作</li>
<li><code>driver.switch_to.frame(&quot;父节点&quot;)</code></li>
<li><code>driver.switch_to.frame(&quot;子节点&quot;)</code></li>
</ul>
</li>
<li><p>一种是未嵌套的</p>
<ul>
<li><p><code>driver.switch_to_frame(&quot;frame的id&quot;)</code></p>
</li>
<li><p><code>driver.switch_to_frame(&quot;frame-index&quot;)</code></p>
<p>  frame无ID的时候依据索引来处理，索引从0开始<code>driver.switch_to_frame(0)</code></p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>切换frame</p>
<ul>
<li><code>driver.switch_to.frame()</code>：根据元素id或者index切换切换frame</li>
<li><code>driver.switch_to.default_content()</code>：切换到默认frame</li>
<li><code>driver.switch_to.parent_frame()</code>：切换到父级frame</li>
</ul>
</li>
</ul>
<p><strong>多frame切换案例：</strong></p>
<ul>
<li><p>打开包含framel的web页面<a target="_blank" rel="noopener" href="https://www.runoob.com/try/try.php?filename=jqueryui-api-droppable">https://www.runoob.com/try/try.php?filename=jqueryui-api-droppable</a></p>
</li>
<li><p>打印“请拖拽我”元素的文本</p>
</li>
<li><p>打印“点击运行”元素的文本</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TestFrame</span>(<span class="title class_ inherited__">Base</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_frame</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.get(<span class="string">&quot;https://www.runoob.com/try/try.php?filename=jqueryui-api-droppable&quot;</span>)</span><br><span class="line">        self.driver.switch_to_frame(<span class="string">&quot;iframeResult&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(self.driver.find_element(By.ID, <span class="string">&quot;draggable&quot;</span>).text)</span><br><span class="line">        <span class="comment"># 切换到父frame</span></span><br><span class="line">        self.driver.switch_to_default_content()</span><br><span class="line">        <span class="comment"># self.driver.switch_to.parent_frame()</span></span><br><span class="line">        self.driver.find_element(By.ID, <span class="string">&quot;submitBTN&quot;</span>).click()</span><br><span class="line">        self.driver.switch_to_frame(<span class="string">&quot;iframeResult&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(self.driver.find_element(By.ID, <span class="string">&quot;droppable&quot;</span>).text)</span><br></pre></td></tr></table></figure></li>
</ul>
<h1 id="8-selenium多浏览器处理"><a href="#8-selenium多浏览器处理" class="headerlink" title="8. selenium多浏览器处理"></a>8. selenium多浏览器处理</h1><ul>
<li>chrome，firefox，headless等浏览器的自动化支持</li>
<li>传不同参数来测试不同的浏览器，用来做浏览器兼容性测试</li>
</ul>
<p><strong>例子：</strong></p>
<p>更新test_base.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _*_ coding: utf-8 _*_</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup</span>(<span class="params">self</span>):</span><br><span class="line">        browser = os.getenv(<span class="string">&quot;browser&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> browser == <span class="string">&#x27;firefox&#x27;</span>:</span><br><span class="line">            self.driver = webdriver.Firefox()</span><br><span class="line">        <span class="keyword">elif</span> browser == <span class="string">&#x27;headless&#x27;</span>:</span><br><span class="line">            self.driver = webdriver.PhantomJS()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            self.driver = webdriver.Chrome()</span><br><span class="line">        self.driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">        self.driver.maximize_window()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">teardown</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.quit()</span><br></pre></td></tr></table></figure>

<p>以test_frame.py为例，执行pytest（进入到py测试文件所在目录下）</p>
<ul>
<li><p>MAC命令</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">browser=chrome pytest test_frame.py</span><br></pre></td></tr></table></figure>
</li>
<li><p>windows命令</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> browser=firefox</span><br><span class="line">pytest test_frame.py</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="9-1-JavaScript简介"><a href="#9-1-JavaScript简介" class="headerlink" title="9.1 JavaScript简介"></a>9.1 JavaScript简介</h2><ul>
<li><p>JavaScript ( JS ) 是一种具有函数优先的轻量级，解释型或即时编译型的编程语言</p>
</li>
<li><p>可以嵌入到HTML页面对浏览器事件做出响应</p>
</li>
<li><p>也可以基于Node.js技术进行服务器端编程</p>
<blockquote>
<p>js推荐使用单引号<code>‘’</code></p>
</blockquote>
</li>
</ul>
<p><strong>js的组成：</strong></p>
<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220406162834245.png" alt="image-20220406162834245" style="zoom: 43%;">

<p><strong>自动化测试中使用JavaSeript脚本:</strong></p>
<ul>
<li>使用场景：部分元素使用selenium原生方法无法解决</li>
<li>执行dom相关的操作：<ul>
<li>点击事件</li>
<li>滚动事件</li>
<li>属性修改</li>
</ul>
</li>
</ul>
<h2 id="9-2-JavaScript简单使用"><a href="#9-2-JavaScript简单使用" class="headerlink" title="9.2 JavaScript简单使用"></a>9.2 JavaScript简单使用</h2><ul>
<li><p>修改元素属性值</p>
<p>  <code>document.querySelector(&quot;#kw&quot;).value = &quot;霍格沃兹测试学院&quot;</code></p>
</li>
<li><p>按钮点击</p>
<p>  <code>document.querySelector(&quot;#su&quot;).click()</code></p>
</li>
<li><p>页面滚动到底部</p>
<p>  <code>document.documentElement.scrollTop = 10000</code></p>
</li>
</ul>
<h2 id="9-3-Selenium执行执行JavaScript"><a href="#9-3-Selenium执行执行JavaScript" class="headerlink" title="9.3 Selenium执行执行JavaScript"></a>9.3 Selenium执行执行JavaScript</h2><ul>
<li>Selenium执行js<ul>
<li><code>execute_script</code>：执行js</li>
<li><code>return</code>：可以返回js的执行结果</li>
</ul>
</li>
</ul>
<h2 id="9-4-JavaScript操作案例"><a href="#9-4-JavaScript操作案例" class="headerlink" title="9.4 JavaScript操作案例"></a>9.4 JavaScript操作案例</h2><h3 id="9-4-1-案例1：滑动"><a href="#9-4-1-案例1：滑动" class="headerlink" title="9.4.1 案例1：滑动"></a>9.4.1 案例1：滑动</h3><p>案例一：滑动到浏览器底部</p>
<ul>
<li>打开百度首页</li>
<li>输入搜索关键字-霍格沃兹测试学院</li>
<li>点击搜索跳转到搜索结果页</li>
<li>滑动到底部</li>
<li>点击下一页</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TestJS1</span>(<span class="title class_ inherited__">Base</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_js</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.get(<span class="string">&quot;https://www.baidu.com/&quot;</span>)</span><br><span class="line">        self.driver.find_element(By.ID, <span class="string">&quot;kw&quot;</span>).send_keys(<span class="string">&quot;霍格沃兹测试学院&quot;</span>)</span><br><span class="line">        self.driver.find_element(By.ID, <span class="string">&quot;su&quot;</span>).click()</span><br><span class="line">        sleep(<span class="number">2</span>)</span><br><span class="line">        self.driver.execute_script(<span class="string">&quot;document.documentElement.scrollTop = 10000&quot;</span>)</span><br><span class="line">        sleep(<span class="number">2</span>)</span><br><span class="line">        self.driver.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;page&quot;]/div/a[10]&#x27;</span>).click()</span><br><span class="line">        sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h3 id="9-4-2-案例2：展示下拉框"><a href="#9-4-2-案例2：展示下拉框" class="headerlink" title="9.4.2 案例2：展示下拉框"></a>9.4.2 案例2：展示下拉框</h3><p>案例二：通过属性修改展示下拉框</p>
<ul>
<li>打开淘宝首页：<a target="_blank" rel="noopener" href="https://www.taobao.com/">https://www.taobao.com/</a></li>
<li>修改下拉框属性</li>
</ul>
<blockquote>
<p>如何选择html下拉框的元素：</p>
<ul>
<li>先在<em>Chrome</em> 开发者工具的控制台输入以下代码：（窗口冻结）</li>
</ul>
<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220406160843525.png" alt="image-20220406160843525" style="zoom: 67%;">

<ul>
<li>再将鼠标悬停到某一元素上，等待3秒，选择相应元素进行查看：</li>
</ul>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220406160828526.png" alt="image-20220406160828526"></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test_js2</span>(<span class="params">self</span>):</span><br><span class="line">    self.driver.get(<span class="string">&quot;https://www.taobao.com/&quot;</span>)</span><br><span class="line">    sleep(<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># querySelector()方法返回文档中匹配指定CSS选择器的一个元素。注意： querySelector()方法仅仅返回匹配指定选择器的第一个元素。.className表示修改class为XXX</span></span><br><span class="line">    self.driver.execute_script(<span class="string">&#x27;document.querySelector(&quot;#J_SiteNavMytaobao&quot;).className=&quot;site-nav-menu site-nav-mytaobao site-nav-multi-menu J_MultiMenu site-nav-menu-hover&quot;&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h3 id="9-4-3-案例3：时间控件"><a href="#9-4-3-案例3：时间控件" class="headerlink" title="9.4.3 案例3：时间控件"></a>9.4.3 案例3：时间控件</h3><p>案例三：通过属性修改时间控件的值</p>
<ul>
<li>打开12306网站：<a target="_blank" rel="noopener" href="https://www.12306.cn/index/">https://www.12306.cn/index/</a></li>
<li>修改时间控件值</li>
<li>打印出发日期</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test_js3</span>(<span class="params">self</span>):</span><br><span class="line">    self.driver.get(<span class="string">&quot;https://www.12306.cn/index/&quot;</span>)</span><br><span class="line">    sleep(<span class="number">2</span>)</span><br><span class="line">    self.driver.execute_script(<span class="string">&#x27;document.querySelector(&quot;#train_date&quot;).value=&quot;2022-12-22&quot;&#x27;</span>)</span><br><span class="line">    sleep(<span class="number">2</span>)</span><br><span class="line">    train_date = self.driver.execute_script(<span class="string">&#x27;return document.querySelector(&quot;#train_date&quot;).value&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(train_date)</span><br><span class="line">    sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h1 id="10-文件上传、弹框处理"><a href="#10-文件上传、弹框处理" class="headerlink" title="10. 文件上传、弹框处理"></a>10. 文件上传、弹框处理</h1><h2 id="10-1-文件上传"><a href="#10-1-文件上传" class="headerlink" title="10.1 文件上传"></a>10.1 文件上传</h2><ul>
<li>input标签可以直接使用<code>send_keys(文件地址)</code>上传文件</li>
<li>用法：<ul>
<li><code>el = driver.find_element_by_id(&#39;上传按钮id&#39;）</code></li>
<li><code>el.send_keys(&quot;文件路径+文件名&quot;)</code></li>
</ul>
</li>
</ul>
<h3 id="10-1-1-文件上传实例"><a href="#10-1-1-文件上传实例" class="headerlink" title="10.1.1 文件上传实例"></a>10.1.1 文件上传实例</h3><ul>
<li>打开百度图片网址：<a target="_blank" rel="noopener" href="https://image.baidu.com/">https://image.Baidu.com</a></li>
<li>识别上传按钮</li>
<li>点击上传按钮</li>
<li>将本地的图片文件上传</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TestFile</span>(<span class="title class_ inherited__">Base</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_file</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.get(<span class="string">&quot;https://image.baidu.com/&quot;</span>)</span><br><span class="line">        self.driver.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;sttb&quot;]/img[1]&#x27;</span>).click()</span><br><span class="line">        sleep(<span class="number">2</span>)</span><br><span class="line">        self.driver.find_element(By.ID, <span class="string">&quot;uploadImg&quot;</span>).send_keys(<span class="string">&quot;../../pic/偷懒.png&quot;</span>)</span><br><span class="line">        sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h2 id="10-2-弹框处理机制"><a href="#10-2-弹框处理机制" class="headerlink" title="10.2 弹框处理机制"></a>10.2 弹框处理机制</h2><ul>
<li>在页面操作中有时会遇到 JavaScript 所生成的<code>alert</code>、<code>confirm</code>以及<code>prompt</code>弹框，可以使用<code>switch_to.alert()</code>方法定位到。然后使用<code>text/accept/dismiss/send_keys</code>等方法进行操作。</li>
<li>操作alert常用的方法：<ul>
<li><code>switch_to_alert()</code>：获取当前页面上的警告框。</li>
<li><code>text</code>：返回alert&#x2F;confirm&#x2F;prompt 中的文字信息。</li>
<li><code>accept()</code>：接受现有警告框。</li>
<li><code>dismiss()</code>：解散现有警告框。</li>
<li><code>send_keys(keysToSend)</code>：发送文本至警告框。keysToSend：将文本发送至警告框。</li>
</ul>
</li>
</ul>
<h3 id="10-2-1-alert窗口处理案例"><a href="#10-2-1-alert窗口处理案例" class="headerlink" title="10.2.1 alert窗口处理案例"></a>10.2.1 alert窗口处理案例</h3><p>测试案例</p>
<ul>
<li>打开网页<a target="_blank" rel="noopener" href="https://www.runoob.com/try/try.php?filename=jqueryui-api-droppable">https://www.runoob.com/try/try.php?filename=jqueryui-api-droppable</a></li>
<li>操作窗口右侧页面，将元素1拖拽到元素2</li>
<li>这时候会有一个alert弹框，点击弹框中的”确定”</li>
<li>然后再按”点击运行”</li>
<li>关闭网页</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TestAlert</span>(<span class="title class_ inherited__">Base</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_alert</span>(<span class="params">self</span>):</span><br><span class="line">        self.driver.get(<span class="string">&quot;https://www.runoob.com/try/try.php?filename=jqueryui-api-droppable&quot;</span>)</span><br><span class="line">        sleep(<span class="number">1</span>)</span><br><span class="line">        self.driver.switch_to_frame(<span class="string">&quot;iframeResult&quot;</span>)</span><br><span class="line">        drag = self.driver.find_element(By.ID, <span class="string">&quot;draggable&quot;</span>)</span><br><span class="line">        drop = self.driver.find_element(By.ID, <span class="string">&quot;droppable&quot;</span>)</span><br><span class="line">        action = ActionChains(self.driver)</span><br><span class="line">        action.drag_and_drop(drag, drop).perform()</span><br><span class="line">        <span class="comment"># action.perform()</span></span><br><span class="line">        sleep(<span class="number">2</span>)</span><br><span class="line">        self.driver.switch_to_alert().accept()</span><br><span class="line">        self.driver.switch_to_default_content()</span><br><span class="line">        self.driver.find_element(By.ID, <span class="string">&quot;submitBTN&quot;</span>)</span><br><span class="line">        sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h1 id="11-pageObject（PO）设计模式"><a href="#11-pageObject（PO）设计模式" class="headerlink" title="11. pageObject（PO）设计模式"></a>11. pageObject（PO）设计模式</h1><p>也叫PageObjectModel（POM）</p>
<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220407105604381.png" alt="image-20220407105604381" style="zoom:50%;">

<h1 id="12-pageObject原则"><a href="#12-pageObject原则" class="headerlink" title="12. pageObject原则"></a>12. pageObject原则</h1><h2 id="12-1-pageObject六大原则"><a href="#12-1-pageObject六大原则" class="headerlink" title="12.1 pageObject六大原则"></a>12.1 pageObject六大原则</h2><ul>
<li><p>The public methods represent the services that the page offers（公共方法表示页面提供的服务）</p>
</li>
<li><p>Try not to expose the internals of the page（尽量不要暴露页面的内部内容）</p>
</li>
<li><p>Generally don’t make assertions（通常不做断言）</p>
</li>
<li><p>Methods return other PageObjects（方法返回其他页面对象）</p>
<p>  如果页面A导航到页面B， Page A 应当return Page B</p>
</li>
<li><p>Need not represent an entire page（不需要代表整个页面）</p>
</li>
<li><p>Different results for the same action are modelled as different methods（同一动作的不同结果被建模为不同的方法）</p>
</li>
</ul>
<p><strong>例子：</strong></p>
<p>Html_fun.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Html_fun</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">title</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_text</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>

<p>main.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> func.Html_fun <span class="keyword">import</span> Html_fun</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Main</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">send_keys</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">click</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">title</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">click_first_link</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    	<span class="comment"># main页面可以跳转到页面Html_fun，所以要返回该页面</span></span><br><span class="line">        <span class="keyword">return</span> Html_fun()</span><br></pre></td></tr></table></figure>

<p>test_pageobject.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> func.main <span class="keyword">import</span> Main</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestPageObject</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">setup</span>(<span class="params">self</span>):</span><br><span class="line">        main = Main()</span><br><span class="line">        <span class="comment"># 可以调用main页面的方法click_first_link，但是main页面可以返回Html_fun，可以继续调用Html_fun页面的方法title</span></span><br><span class="line">        main.click_first_link().title()</span><br></pre></td></tr></table></figure>

<h1 id="13-企业微信的自动化登录"><a href="#13-企业微信的自动化登录" class="headerlink" title="13. 企业微信的自动化登录"></a>13. 企业微信的自动化登录</h1><h2 id="13-1-Web自动化测试之复用浏览器"><a href="#13-1-Web自动化测试之复用浏览器" class="headerlink" title="13.1 Web自动化测试之复用浏览器"></a>13.1 Web自动化测试之复用浏览器</h2><h3 id="13-1-1-为什么要学习复用浏览器"><a href="#13-1-1-为什么要学习复用浏览器" class="headerlink" title="13.1.1 为什么要学习复用浏览器"></a>13.1.1 为什么要学习复用浏览器</h3><ul>
<li>自动化测试过程中，存在人为介入场景</li>
<li>提高调试UI自动化测试脚本效率</li>
</ul>
<h3 id="13-1-2-复用已有浏览器—配置步骤"><a href="#13-1-2-复用已有浏览器—配置步骤" class="headerlink" title="13.1.2 复用已有浏览器—配置步骤"></a>13.1.2 复用已有浏览器—配置步骤</h3><ul>
<li><p>需要退出当前所有的谷歌浏览器（特别注意）</p>
<blockquote>
<p>mac：图标右键退出谷歌浏览器</p>
<p>Windows：退出后，还要在任务管理器关闭谷歌浏览器进程</p>
</blockquote>
</li>
<li><p>输入启动命令，通过命令启动谷歌浏览器</p>
</li>
<li><p>找到chrome的启动路径</p>
</li>
<li><p>配置环境变量</p>
</li>
<li><p>验证是否启动成功</p>
</li>
</ul>
<h4 id="【1】windows环境变量配置："><a href="#【1】windows环境变量配置：" class="headerlink" title="【1】windows环境变量配置："></a>【1】windows环境变量配置：</h4><ul>
<li>获取启动路径</li>
</ul>
<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220407141602262.png" alt="image-20220407141602262" style="zoom: 45%;">

<ul>
<li><p>配置环境变量</p>
  <img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220407141835337.png" alt="image-20220407141835337" style="zoom: 35%;">
</li>
<li><p>重启命令行 ( 包括谷歌，pycharm，cmd )</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chrome --remote-debugging-port=9222</span><br></pre></td></tr></table></figure>
</li>
<li><p>验证是否启动成功</p>
<p>  在谷歌浏览器的网址输入<code>localhost:9222</code>，如果页面没有报错，那么说明调试模式的浏览器启动成功</p>
</li>
</ul>
<h4 id="【2】Mac环境变量配置"><a href="#【2】Mac环境变量配置" class="headerlink" title="【2】Mac环境变量配置"></a>【2】Mac环境变量配置</h4><ul>
<li><p>获取启动路径（注意：使用tab键，不要手动输入）</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/Applications/Google\ Chrome.app/Contents/MacOS</span><br></pre></td></tr></table></figure>
</li>
<li><p>将启动路径配置到环境变量中（举例）</p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Google\ Chrome --remote-debugging-port=9222</span><br></pre></td></tr></table></figure>
</li>
<li><p>验证是否启动成功</p>
<p>  在谷歌浏览器的网址输入<code>localhost:9222</code>，如果页面没有报错，那么说明调试模式的浏览器启动成功</p>
</li>
</ul>
<h3 id="13-1-3-复用已有浏览器—代码设置"><a href="#13-1-3-复用已有浏览器—代码设置" class="headerlink" title="13.1.3 复用已有浏览器—代码设置"></a>13.1.3 复用已有浏览器—代码设置</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.options <span class="keyword">import</span> Options</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义配置的实例对象option</span></span><br><span class="line">option = Options()</span><br><span class="line"><span class="comment"># 修改实例属性为 debug 模式启动的 ip + 端口</span></span><br><span class="line">option.debugger_address = <span class="string">&quot;localhost:9222&quot;</span></span><br><span class="line"><span class="comment"># 实例化 driver 的时候，添加 option 配置</span></span><br><span class="line">driver = webdriver.Chrome(options=option)</span><br></pre></td></tr></table></figure>

<h3 id="13-1-3-复用浏览器实战演示1"><a href="#13-1-3-复用浏览器实战演示1" class="headerlink" title="13.1.3 复用浏览器实战演示1"></a>13.1.3 复用浏览器实战演示1</h3><ul>
<li>问题1：企业微信登录无法通过输入用户名密码的方式解决登录问题，后面所有的脚本都无法执行。</li>
<li>解决方案：通过remote复用浏览器人工登录企业微信。后面的脚本自动执行</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.options <span class="keyword">import</span> Options</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义配置的实例对象option</span></span><br><span class="line">option = Options()</span><br><span class="line"><span class="comment"># 修改实例属性为 debug 模式启动的 ip + 端口</span></span><br><span class="line">option.debugger_address = <span class="string">&quot;localhost:9222&quot;</span></span><br><span class="line"><span class="comment"># 实例化 driver 的时候，添加 option 配置</span></span><br><span class="line">driver = webdriver.Chrome(options=option)</span><br><span class="line">driver.get(<span class="string">&quot;https://work.weixin.qq.com/wework_admin/frame&quot;</span>)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 点击添加用户</span></span><br><span class="line">driver.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;_hmt_click&quot;]/div[1]/div[4]/div[2]/a[1]/div/span[2]&#x27;</span>).click()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>

<h3 id="13-1-4-复用浏览器实战演示2"><a href="#13-1-4-复用浏览器实战演示2" class="headerlink" title="13.1.4 复用浏览器实战演示2"></a>13.1.4 复用浏览器实战演示2</h3><ul>
<li>问题2：编写自动化测试脚本过程中，用例的某一步骤出现问题。调试时需要将此步骤前面所有的步骤执行完成之后再复现调试。</li>
<li>解决方案：使用复用浏览器的方式跳过前面的自动化执行步骤，轻松复现出问题的场景，只对问题行代码进行调试。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.options <span class="keyword">import</span> Options</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义配置的实例对象option</span></span><br><span class="line">option = Options()</span><br><span class="line"><span class="comment"># 修改实例属性为 debug 模式启动的 ip + 端口</span></span><br><span class="line">option.debugger_address = <span class="string">&quot;localhost:9222&quot;</span></span><br><span class="line"><span class="comment"># 实例化 driver 的时候，添加 option 配置</span></span><br><span class="line">driver = webdriver.Chrome(options=option)</span><br><span class="line">driver.get(<span class="string">&quot;https://work.weixin.qq.com/wework_admin/frame&quot;</span>)</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 点击添加用户</span></span><br><span class="line">driver.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;_hmt_click&quot;]/div[1]/div[4]/div[2]/a[1]/div/span[2]&#x27;</span>).click()</span><br><span class="line">sleep(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 输入姓名</span></span><br><span class="line">driver.find_element_by_id(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;yyl&quot;</span>)</span><br></pre></td></tr></table></figure>

<h2 id="13-2-cookie"><a href="#13-2-cookie" class="headerlink" title="13.2 cookie"></a>13.2 cookie</h2><h3 id="13-2-1-cookie是什么"><a href="#13-2-1-cookie是什么" class="headerlink" title="13.2.1 cookie是什么"></a>13.2.1 cookie是什么</h3><p>Cookie 是一些数据，存储于你电脑上的文本文件中。当web服务器向浏览器发送web页面时，在连接关闭后，服务端不会记录用户的信息</p>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220407162024089.png" alt="image-20220407162024089"></p>
<h3 id="13-2-2-为什么要使用Cookie自动化登录"><a href="#13-2-2-为什么要使用Cookie自动化登录" class="headerlink" title="13.2.2 为什么要使用Cookie自动化登录"></a>13.2.2 为什么要使用Cookie自动化登录</h3><ul>
<li>复用浏览器仍然在每次用例开始都需要人为介入</li>
<li>若用例需要经常执行，复用浏览器则不是一个好的选择</li>
<li>大部分cookie的时效性都很长，扫一次可以使用多次</li>
</ul>
<img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/image-20220407163523147.png" alt="image-20220407163523147" style="zoom:40%;">

<blockquote>
<p>常见问题：</p>
<ul>
<li>企业微信cookie有互踢机制。在获取cookie成功之后。<font color="red">不要再进行扫码操作</font></li>
<li>获取cookie的时候，即执行代码<code>get_cookies()</code>时，<font color="red">一定要确保已经登录</font></li>
<li>植入cookie之后需要进入登录页面，刷新验证是否自动登录成功。</li>
</ul>
</blockquote>
<h3 id="13-2-3-使用cookie登录"><a href="#13-2-3-使用cookie登录" class="headerlink" title="13.2.3 使用cookie登录"></a>13.2.3 使用cookie登录</h3><ul>
<li>获取<code>cookie driver.get_cookies()</code></li>
<li>添加 <code>cookie driver.add_cookie(cookie)</code></li>
</ul>
<h3 id="13-2-4-实战之获取cookie"><a href="#13-2-4-实战之获取cookie" class="headerlink" title="13.2.4 实战之获取cookie"></a>13.2.4 实战之获取cookie</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">from</span> test_pytest.test_base <span class="keyword">import</span> Base</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestGetCookie</span>(<span class="title class_ inherited__">Base</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_get_cookie</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 访问企业微信登录页面</span></span><br><span class="line">        self.driver.get(<span class="string">&quot;https://work.weixin.qq.com/wework_admin/frame&quot;</span>)</span><br><span class="line">        <span class="comment"># 等待20秒人工扫码操作</span></span><br><span class="line">        sleep(<span class="number">20</span>)</span><br><span class="line">        <span class="comment"># 登录成功后，再去获取 cookie 信息</span></span><br><span class="line">        cookie = self.driver.get_cookies()</span><br><span class="line">        <span class="built_in">print</span>(cookie)</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#123;<span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;.work.weixin.qq.com&#x27;</span>, <span class="string">&#x27;httpOnly&#x27;</span>: True, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;wwrtx.logined&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;secure&#x27;</span>: False, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;true&#x27;</span>&#125;, &#123;<span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;.work.weixin.qq.com&#x27;</span>, <span class="string">&#x27;httpOnly&#x27;</span>: False, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;wwrtx.cs_ind&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;secure&#x27;</span>: False, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;&#x27;&#125;, &#123;&#x27;</span>domain<span class="number">&#x27;</span>: <span class="string">&#x27;.work.weixin.qq.com&#x27;</span>, <span class="string">&#x27;httpOnly&#x27;</span>: False, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;wxpay.vid&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;secure&#x27;</span>: False, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1688854308330636&#x27;</span>&#125;, &#123;<span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;.work.weixin.qq.com&#x27;</span>, <span class="string">&#x27;httpOnly&#x27;</span>: False, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;wxpay.corpid&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;secure&#x27;</span>: False, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1970325697979342&#x27;</span>&#125;, &#123;<span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;.work.weixin.qq.com&#x27;</span>, <span class="string">&#x27;httpOnly&#x27;</span>: False, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;wwrtx.vid&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;secure&#x27;</span>: False, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1688854308330636&#x27;</span>&#125;, &#123;<span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;.work.weixin.qq.com&#x27;</span>, <span class="string">&#x27;httpOnly&#x27;</span>: True, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;wwrtx.ref&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;secure&#x27;</span>: False, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;direct&#x27;</span>&#125;, &#123;<span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;.work.weixin.qq.com&#x27;</span>, <span class="string">&#x27;httpOnly&#x27;</span>: True, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;wwrtx.ltype&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;secure&#x27;</span>: False, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1&#x27;</span>&#125;, &#123;<span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;.work.weixin.qq.com&#x27;</span>, <span class="string">&#x27;httpOnly&#x27;</span>: True, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;wwrtx.refid&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;secure&#x27;</span>: False, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;1526602970601800&#x27;</span>&#125;, &#123;<span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;.work.weixin.qq.com&#x27;</span>, <span class="string">&#x27;httpOnly&#x27;</span>: True, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;wwrtx.sid&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;secure&#x27;</span>: False, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;Q_XlaVNHTvH73y0X-zLYL0FlLS1hveX8NB9YZtMP9eNAmuedzMqh3URVH9YP5Onm&#x27;</span>&#125;, &#123;<span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;.work.weixin.qq.com&#x27;</span>, <span class="string">&#x27;expiry&#x27;</span>: <span class="number">1680858600</span>, <span class="string">&#x27;httpOnly&#x27;</span>: False, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;wwrtx.c_gdpr&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;secure&#x27;</span>: False, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;0&#x27;</span>&#125;, &#123;<span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;.work.weixin.qq.com&#x27;</span>, <span class="string">&#x27;httpOnly&#x27;</span>: False, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;wwrtx.d2st&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;secure&#x27;</span>: False, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;a6767072&#x27;</span>&#125;, &#123;<span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;.work.weixin.qq.com&#x27;</span>, <span class="string">&#x27;httpOnly&#x27;</span>: True, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;wwrtx.vst&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;secure&#x27;</span>: False, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;tGvI3Uxd2lC3KNHn3IZ7bLWbZMgOFAu3ODuM2prpU2vc29i152lddB0jUq6mX_EfrMWpNOtNF53Mdm0x0Wp2by4XiMvHoC8dYVKGGL5Sa0DlftlhUkxQgIgRHZistXpGevoxq1cMovsg39mEnWk_7Wd8OVAt7dowoaHMDXgHwZjri6iFQFE6XsmVHuo-BxWTN7VG0g0svQxHGX8tj8c9iZdE2gCNKPaI4kT_66eZCk_VEn0bSujEKK8BvZKz0m4iGVHJimn2vNc9r1ckyCxqOg&#x27;</span>&#125;, &#123;<span class="string">&#x27;domain&#x27;</span>: <span class="string">&#x27;.work.weixin.qq.com&#x27;</span>, <span class="string">&#x27;expiry&#x27;</span>: <span class="number">1651914612</span>, <span class="string">&#x27;httpOnly&#x27;</span>: False, <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;wwrtx.i18n_lan&#x27;</span>, <span class="string">&#x27;path&#x27;</span>: <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;secure&#x27;</span>: False, <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;zh&#x27;</span>&#125;]</span><br></pre></td></tr></table></figure>

<h3 id="13-2-5-实战之cookie植入"><a href="#13-2-5-实战之cookie植入" class="headerlink" title="13.2.5  实战之cookie植入"></a>13.2.5  实战之cookie植入</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep</span><br><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"><span class="keyword">from</span> test_pytest.test_base <span class="keyword">import</span> Base</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestGetCookie</span>(<span class="title class_ inherited__">Base</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_get_cookie</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 访问企业微信登录页面</span></span><br><span class="line">        self.driver.get(<span class="string">&quot;https://work.weixin.qq.com/wework_admin/frame&quot;</span>)</span><br><span class="line">        <span class="comment"># 等待10秒人工扫码操作</span></span><br><span class="line">        sleep(<span class="number">10</span>)</span><br><span class="line">        <span class="comment"># 登录成功后，再去获取 cookie 信息</span></span><br><span class="line">        cookie = self.driver.get_cookies()</span><br><span class="line">        <span class="comment"># 将cookie存入一个可持久存储的地方，文件</span></span><br><span class="line">        <span class="comment"># 打开文件的时候添加写入权限</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;../data/cookie.yml&#x27;</span>, <span class="string">&#x27;w+&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            yaml.safe_dump(cookie, file)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">test_add_cookie</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 访问企业微信主界面</span></span><br><span class="line">        self.driver.get(<span class="string">&quot;https://work.weixin.qq.com/wework_admin/frame#contacts&quot;</span>)</span><br><span class="line">        <span class="comment"># 定义cookies，cookie信息从已经写入的cookie文件中获取</span></span><br><span class="line">        cookies = yaml.safe_load(<span class="built_in">open</span>(<span class="string">&#x27;../data/cookie.yml&#x27;</span>, mode=<span class="string">&#x27;r&#x27;</span>))</span><br><span class="line">        sleep(<span class="number">2</span>)</span><br><span class="line">        <span class="comment"># 植入cookies——cookie是单个的字典信息</span></span><br><span class="line">        <span class="keyword">for</span> c <span class="keyword">in</span> cookies:</span><br><span class="line">            self.driver.add_cookie(c)</span><br><span class="line">        sleep(<span class="number">3</span>)</span><br><span class="line">        <span class="comment"># 再次访问企业微信页面，发现无需扫码自动登录，而且可以多次使用</span></span><br><span class="line">        self.driver.get(<span class="string">&quot;https://work.weixin.qq.com/wework_admin/frame#contacts&quot;</span>)</span><br></pre></td></tr></table></figure>

<h1 id="14-企业微信web端自动化测试实战"><a href="#14-企业微信web端自动化测试实战" class="headerlink" title="14. 企业微信web端自动化测试实战"></a>14. 企业微信web端自动化测试实战</h1><h2 id="1-UI-自动化技术"><a href="#1-UI-自动化技术" class="headerlink" title="( 1 ) UI 自动化技术"></a>( 1 ) UI 自动化技术</h2><ul>
<li>Web自动化测试（BS）：Selenium、Cypress、Airtest</li>
<li>App自动化测试（CS）：Appium、ATX、Airtest</li>
</ul>
<h2 id="2-selenium3"><a href="#2-selenium3" class="headerlink" title="( 2 ) selenium3"></a>( 2 ) selenium3</h2><p>官网：<a target="_blank" rel="noopener" href="https://www.selenium.dev/documentation/">https://www.selenium.dev/documentation/</a></p>
<h2 id="3-自动化测试用例设计"><a href="#3-自动化测试用例设计" class="headerlink" title="( 3 ) 自动化测试用例设计"></a>( 3 ) 自动化测试用例设计</h2><p>UI自动化测试场景：</p>
<p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/POv1Qi9G48RtESLSe0krgooyX2SGSI5O1MttGaEh9h4BOw0QAn74eAql8g8s5Y_Zp9kiUWKJeaNiRhxX__wPVE6nMWDQwonwk9b8JyTjKxbXkCk2tDiHiFXYhw52AcPyUUVN6ROzDEp4OArFpgTodOtTNB5Sh9IU7bH80_lFqlBgvmsrfkmQVotA9HbRs3BbN8JkEXoELSW0Ybq2q.svg"></p>
<h3 id="【1】传统UI代码"><a href="#【1】传统UI代码" class="headerlink" title="【1】传统UI代码"></a>【1】传统UI代码</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_add_member</span>():</span><br><span class="line">    <span class="comment"># 1.登录</span></span><br><span class="line">    <span class="comment"># 2，进入首页页面</span></span><br><span class="line">    driver = webdriver.Chrome()</span><br><span class="line">    driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">    driver.maximize_window()</span><br><span class="line">    driver.get(<span class="string">&quot;https://work.weixin.qq.com/wework_admin/frame#index&quot;</span>)</span><br><span class="line">    time.sleep(<span class="number">10</span>)</span><br><span class="line">    <span class="comment"># 3，点击&quot;添加成员&quot;按钮</span></span><br><span class="line">    driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;_hmt_click&quot;]/div[1]/div[4]/div[2]/a[1]/div/span[2]&#x27;</span>).click()</span><br><span class="line">    <span class="comment"># 4.填写成员信息</span></span><br><span class="line">    driver.find_element_by_id(<span class="string">&quot;username&quot;</span>).send_keys(<span class="string">&quot;小花&quot;</span>)</span><br><span class="line">    driver.find_element_by_id(<span class="string">&quot;memberAdd_acctid&quot;</span>).send_keys(<span class="string">&quot;001&quot;</span>)</span><br><span class="line">    driver.find_element_by_id(<span class="string">&quot;memberAdd_biz_mail&quot;</span>).send_keys(<span class="string">&quot;xiaohua001&quot;</span>)</span><br><span class="line">    driver.find_element_by_id(<span class="string">&quot;memberAdd_phone&quot;</span>).send_keys(<span class="string">&quot;18011112222&quot;</span>)</span><br><span class="line">    <span class="comment"># 5.点击&quot;保存&quot;按钮</span></span><br><span class="line">    <span class="comment"># 6.进入通讯录页面</span></span><br><span class="line">    driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;js_contacts52&quot;]/div/div[2]/div/div[4]/div/form/div[1]/a[2]&#x27;</span>).click()</span><br><span class="line">    <span class="comment"># 7.验证=&gt;断言</span></span><br></pre></td></tr></table></figure>

<p>传统代码痛点：</p>
<ul>
<li>大段重复代码</li>
<li>无法适应UI变化</li>
</ul>
<h3 id="【2】PO设计思想"><a href="#【2】PO设计思想" class="headerlink" title="【2】PO设计思想"></a>【2】PO设计思想</h3><p>官网：<a target="_blank" rel="noopener" href="https://www.selenium.dev/zh-cn/documentation/test_practices/encouraged/page_object_models/">https://www.selenium.dev/zh-cn/documentation/test_practices/encouraged/page_object_models/</a></p>
<ul>
<li>分工</li>
<li>页面 &#x3D;&#x3D;&gt; 类<ul>
<li>属性（名词）：元素</li>
<li>方法（动词）：功能</li>
</ul>
</li>
</ul>
<p><strong>PO原则解读：</strong></p>
<ul>
<li>属性意义<ul>
<li>不要暴露页面内部的元素给外部</li>
<li>不需要建模UI内的所有元素</li>
</ul>
</li>
<li>方法意义<ul>
<li>用公共方法代表UI所提供的功能</li>
<li>方法应该返回其他的PageObject或者返回用于断言的数据</li>
<li>同样的行为不同的结果可以建模为不同的方法</li>
<li>不要在方法内加断言</li>
</ul>
</li>
</ul>
<p><strong>PO模式下代码：</strong></p>
<p>（1）需求：</p>
<ol>
<li>登录</li>
<li>进入【首页页面】</li>
<li>点击【首页的】添加成员”按钮</li>
<li>在【成员页面】填写成员信息</li>
<li>点击【成员页面】的”保存”按钮</li>
<li>进入【通讯录页面】</li>
<li>断言</li>
</ol>
<p>（2）PageObject：类</p>
<ul>
<li><p>首页main_page</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MainPage</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    首页</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, driver</span>):</span><br><span class="line">        self.driver = driver</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">click_add_member_button</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        点击”添加成员“按钮</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">from</span> web_test_actual_combat.page_object.member_page <span class="keyword">import</span> MemberPage</span><br><span class="line">        self.driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;_hmt_click&quot;]/div[1]/div[4]/div[2]/a[1]/div/span[2]&#x27;</span>).click()</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> MemberPage(self.driver)</span><br></pre></td></tr></table></figure>
</li>
<li><p>成员页面member_page</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MemberPage</span>:</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    添加成员页面</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, driver</span>):</span><br><span class="line">        self.driver = driver</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">add_member_info</span>(<span class="params">self, name, acctid, mail, phone</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        添加成员信息，并保存</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">from</span> web_test_actual_combat.page_object.contact_page <span class="keyword">import</span> ContactPage</span><br><span class="line">        <span class="comment"># 填写成员信息</span></span><br><span class="line">        self.driver.find_element_by_id(<span class="string">&quot;username&quot;</span>).send_keys(name)</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">&quot;memberAdd_acctid&quot;</span>).send_keys(acctid)</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">&quot;memberAdd_biz_mail&quot;</span>).send_keys(mail)</span><br><span class="line">        self.driver.find_element_by_id(<span class="string">&quot;memberAdd_phone&quot;</span>).send_keys(phone)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        self.driver.find_element_by_xpath(<span class="string">&#x27;//*[@id=&quot;js_contacts76&quot;]/div/div[2]/div/div[4]/div/form/div[1]/a[2]&#x27;</span>).click()</span><br><span class="line">        <span class="keyword">return</span> ContactPage(self.driver)</span><br></pre></td></tr></table></figure>
</li>
<li><p>通讯录页面contact_page</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ContactPage</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, driver</span>):</span><br><span class="line">        self.driver = driver</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_member_names</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        获取通讯录成员</span></span><br><span class="line"><span class="string">        :return:</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="comment"># self.driver.find_element_by_xpath(&#x27;//*[@id=&quot;member_list&quot;]/tr[1]/td[2]&#x27;)</span></span><br><span class="line">        element = self.driver.find_elements_by_css_selector(<span class="string">&quot;.member_colRight_memberTable_td:nth-child(2)&quot;</span>)</span><br><span class="line">        name_list = [ele.get_attribute(<span class="string">&quot;title&quot;</span>) <span class="keyword">for</span> ele <span class="keyword">in</span> element]</span><br><span class="line">        <span class="keyword">return</span> name_list</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="【3】企业微信PO建模"><a href="#【3】企业微信PO建模" class="headerlink" title="【3】企业微信PO建模"></a>【3】企业微信PO建模</h3><p><img src="/2022/03/30/Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/UxAdyScEMK_thNkoV-6J7RjVBjpwSkuY1LqxXPSDirwiM_zqxrIea9M2eTxpffrFstV3PRYUuDByRFlkfrqBddLCU3fn1aJKIi48gXrPZWlT5XnwZR7fnLI8nTrM2YPwJnUkVjes4wBmnTQMPzDclj_J0p7moVwvJzTYTGQ6EQPwB_gsF-sV1Z7dQSVq5mjNF9ksziMA1W00.svg"></p>
<ul>
<li>黄色的方块代表一个类</li>
<li>每条线代表这个页面提供的方法</li>
<li>箭头的始端为开始页面</li>
<li>箭头的末端为跳转页面或需要断言的数据</li>
</ul>
<p>获取yam</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/03/30/24-4-web%E7%AB%AF%E5%B8%B8%E8%A7%81Bug%E8%A7%A3%E6%9E%90/" rel="prev" title="24.4 web端常见Bug解析">
      <i class="fa fa-chevron-left"></i> 24.4 web端常见Bug解析
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/04/01/25-%E6%9F%90%E7%9F%A5%E5%90%8D%E7%BD%91%E7%AB%99%E6%B5%8B%E8%AF%95%E5%AE%9E%E6%88%98/" rel="next" title="25.某知名网站测试实战">
      25.某知名网站测试实战 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-Selenium%E7%9A%84%E5%AE%89%E8%A3%85"><span class="nav-text">1. Selenium的安装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-Selenium%E7%9A%84%E7%AE%80%E4%BB%8B"><span class="nav-text">1.1 Selenium的简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-Selenium%E6%9E%B6%E6%9E%84"><span class="nav-text">1.2 Selenium架构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-Selenium%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE%E6%AD%A5%E9%AA%A4"><span class="nav-text">1.3 Selenium环境配置步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4-Selenium%E7%9A%84%E5%AE%89%E8%A3%85"><span class="nav-text">1.4  Selenium的安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-5-Driver%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="nav-text">1.5 Driver的配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-6-selenium%E5%9C%A8python%E4%B8%AD%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8"><span class="nav-text">1.6 selenium在python中如何使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-SeleniumIDE%E7%9A%84%E7%94%A8%E4%BE%8B%E5%BD%95%E5%88%B6"><span class="nav-text">2. SeleniumIDE的用例录制</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-SeleniumlDE%E7%94%A8%E4%BE%8B%E5%BD%95%E5%88%B6%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="nav-text">2.1 SeleniumlDE用例录制使用场景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-SeleniumIDE%E7%9A%84%E4%B8%8B%E8%BD%BD%E5%8F%8A%E5%AE%89%E8%A3%85"><span class="nav-text">2.2 SeleniumIDE的下载及安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-%E5%90%AF%E5%8A%A8"><span class="nav-text">2.3 启动</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-4-SeleniumIDE%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD"><span class="nav-text">2.4 SeleniumIDE常用功能</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-5-%E4%BD%BF%E7%94%A8SeleniumIDE"><span class="nav-text">2.5 使用SeleniumIDE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#step1%EF%BC%9A%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="nav-text">step1：创建项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step2%EF%BC%9A%E5%BC%80%E5%A7%8B%E5%BD%95%E5%88%B6"><span class="nav-text">step2：开始录制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step3%EF%BC%9A%E7%BB%93%E6%9D%9F%E5%BD%95%E5%88%B6"><span class="nav-text">step3：结束录制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step4%EF%BC%9A%E5%9B%9E%E6%94%BE"><span class="nav-text">step4：回放</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step5%EF%BC%9A%E6%96%B0%E5%BB%BA%E6%B5%8B%E8%AF%95"><span class="nav-text">step5：新建测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step5%EF%BC%9A%E5%88%9B%E5%BB%BA%E6%B5%8B%E8%AF%95%E9%9B%86"><span class="nav-text">step5：创建测试集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step6%EF%BC%9A%E5%AF%BC%E5%87%BA"><span class="nav-text">step6：导出</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-Selenium%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E7%BC%96%E5%86%99"><span class="nav-text">3. Selenium测试用例编写</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E7%9A%84%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0"><span class="nav-text">3.1 测试用例的核心要素</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-Selenium%E4%B8%AD%E5%A6%82%E4%BD%95%E7%BC%96%E5%86%99%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B"><span class="nav-text">3.2 Selenium中如何编写测试用例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-Selenium%E4%B8%89%E7%A7%8D%E7%AD%89%E5%BE%85%E6%96%B9%E5%BC%8F"><span class="nav-text">4. Selenium三种等待方式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#4-1-%E7%9B%B4%E6%8E%A5%E7%AD%89%E5%BE%85"><span class="nav-text">4.1 直接等待</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-2-%E9%9A%90%E5%BC%8F%E7%AD%89%E5%BE%85"><span class="nav-text">4.2 隐式等待</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-3-%E6%98%BE%E5%BC%8F%E7%AD%89%E5%BE%85"><span class="nav-text">4.3 显式等待</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-web%E6%8E%A7%E4%BB%B6%E5%AE%9A%E4%BD%8D%E4%B8%8E%E5%B8%B8%E8%A7%81%E6%93%8D%E4%BD%9C"><span class="nav-text">5. web控件定位与常见操作</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-1-Selenium%E7%9A%84%E7%82%B9%E5%87%BB%E5%92%8C%E8%BE%93%E5%85%A5"><span class="nav-text">5.1 Selenium的点击和输入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-2-xpath"><span class="nav-text">5.2 xpath</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%AE%9A%E4%B9%89"><span class="nav-text">(1) 定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-XPath%E8%AF%AD%E6%B3%95"><span class="nav-text">(2)XPath语法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-text">表达式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B0%93%E8%AF%AD-%E6%9D%A1%E4%BB%B6"><span class="nav-text">谓语(条件)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-Css-Selector"><span class="nav-text">5.3 Css Selector</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-id%E9%80%89%E6%8B%A9%E5%99%A8-%E8%BA%AB%E4%BB%BD%E9%80%89%E6%8B%A9%E5%99%A8"><span class="nav-text">1. id选择器 身份选择器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-class%E9%80%89%E6%8B%A9%E5%99%A8-%E7%B1%BB%E9%80%89%E6%8B%A9%E5%99%A8"><span class="nav-text">2. class选择器 类选择器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-tag%E9%80%89%E6%8B%A9%E5%99%A8-%E6%A0%87%E7%AD%BE%E9%80%89%E6%8B%A9%E5%99%A8"><span class="nav-text">3. tag选择器 标签选择器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E7%A9%BA%E6%A0%BC"><span class="nav-text">4. 空格</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-gt-%E5%A4%A7%E4%BA%8E%E5%8F%B7"><span class="nav-text">5. &gt; 大于号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E5%8A%A0%E5%8F%B7"><span class="nav-text">6. + 加号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-%E6%B3%A2%E6%B5%AA%E7%BA%BF"><span class="nav-text">7. ~ 波浪线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-%E6%98%9F%E5%8F%B7"><span class="nav-text">8. * 星号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-%E5%B1%9E%E6%80%A7%E9%80%89%E6%8B%A9%E5%99%A8-attribute"><span class="nav-text">9. 属性选择器 attribute</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-%E4%BC%AA%E7%B1%BB-pseudo-class"><span class="nav-text">10. 伪类 pseudo class</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E5%AE%9E%E4%BE%8B%EF%BC%9A"><span class="nav-text">详细实例：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90"><span class="nav-text">例子</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#6-web%E6%8E%A7%E4%BB%B6%E7%9A%84%E4%BA%A4%E4%BA%92%E8%BF%9B%E9%98%B6"><span class="nav-text">6. web控件的交互进阶</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#6-1-ActionChains-%E5%8A%A8%E4%BD%9C%E9%93%BE%E6%8E%A5"><span class="nav-text">6.1 ActionChains 动作链接</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-1-%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-text">6.1.1 基本用法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-2-%E5%85%B7%E4%BD%93%E5%86%99%E6%B3%95"><span class="nav-text">6.1.2 具体写法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-3-ActionChains-%E7%94%A8%E6%B3%951"><span class="nav-text">6.1.3 ActionChains 用法1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-4-ActionChains-%E7%94%A8%E6%B3%952"><span class="nav-text">6.1.4 ActionChains 用法2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-5-ActionChains-%E7%94%A8%E6%B3%953"><span class="nav-text">6.1.5 ActionChains 用法3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-6-ActionChains-%E7%94%A8%E6%B3%954"><span class="nav-text">6.1.6 ActionChains 用法4</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-2-TouchActions"><span class="nav-text">6.2 TouchActions</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-1-TouchActions%E5%AE%9E%E4%BE%8B"><span class="nav-text">6.2.1 TouchActions实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-3-%E8%A1%A8%E5%8D%95%E6%93%8D%E4%BD%9C"><span class="nav-text">6.3 表单操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-1-%E6%8F%90%E4%BA%A4%E8%A1%A8%E5%8D%95%E5%AE%9E%E4%BE%8B"><span class="nav-text">6.3.1 提交表单实例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#7-%E5%A4%9A%E7%AA%97%E5%8F%A3%E5%A4%84%E7%90%86%E4%B8%8E%E7%BD%91%E9%A1%B5frame"><span class="nav-text">7. 多窗口处理与网页frame</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#7-1-selenium%E9%87%8C%E9%9D%A2%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%E5%A4%9A%E7%AA%97%E5%8F%A3%E5%9C%BA%E6%99%AF"><span class="nav-text">7.1 selenium里面如何处理多窗口场景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-2-%E5%A4%9A%E4%B8%AA%E7%AA%97%E5%8F%A3%E8%AF%86%E5%88%AB"><span class="nav-text">7.2 多个窗口识别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-3-%E5%A4%9A%E4%B8%AA%E7%AA%97%E5%8F%A3%E4%B9%8B%E9%97%B4%E5%88%87%E6%8D%A2"><span class="nav-text">7.3 多个窗口之间切换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-4-selenium%E9%87%8C%E9%9D%A2%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86frame"><span class="nav-text">7.4 selenium里面如何处理frame</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-5-%E5%A4%9A%E4%B8%AAframe%E8%AF%86%E5%88%AB"><span class="nav-text">7.5 多个frame识别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-6-%E5%A4%9A%E4%B8%AAframe%E4%B9%8B%E9%97%B4%E5%88%87%E6%8D%A2"><span class="nav-text">7.6 多个frame之间切换</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#8-selenium%E5%A4%9A%E6%B5%8F%E8%A7%88%E5%99%A8%E5%A4%84%E7%90%86"><span class="nav-text">8. selenium多浏览器处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#9-1-JavaScript%E7%AE%80%E4%BB%8B"><span class="nav-text">9.1 JavaScript简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-2-JavaScript%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8"><span class="nav-text">9.2 JavaScript简单使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-3-Selenium%E6%89%A7%E8%A1%8C%E6%89%A7%E8%A1%8CJavaScript"><span class="nav-text">9.3 Selenium执行执行JavaScript</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-4-JavaScript%E6%93%8D%E4%BD%9C%E6%A1%88%E4%BE%8B"><span class="nav-text">9.4 JavaScript操作案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-4-1-%E6%A1%88%E4%BE%8B1%EF%BC%9A%E6%BB%91%E5%8A%A8"><span class="nav-text">9.4.1 案例1：滑动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-4-2-%E6%A1%88%E4%BE%8B2%EF%BC%9A%E5%B1%95%E7%A4%BA%E4%B8%8B%E6%8B%89%E6%A1%86"><span class="nav-text">9.4.2 案例2：展示下拉框</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-4-3-%E6%A1%88%E4%BE%8B3%EF%BC%9A%E6%97%B6%E9%97%B4%E6%8E%A7%E4%BB%B6"><span class="nav-text">9.4.3 案例3：时间控件</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#10-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E3%80%81%E5%BC%B9%E6%A1%86%E5%A4%84%E7%90%86"><span class="nav-text">10. 文件上传、弹框处理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#10-1-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-text">10.1 文件上传</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#10-1-1-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%AE%9E%E4%BE%8B"><span class="nav-text">10.1.1 文件上传实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-2-%E5%BC%B9%E6%A1%86%E5%A4%84%E7%90%86%E6%9C%BA%E5%88%B6"><span class="nav-text">10.2 弹框处理机制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#10-2-1-alert%E7%AA%97%E5%8F%A3%E5%A4%84%E7%90%86%E6%A1%88%E4%BE%8B"><span class="nav-text">10.2.1 alert窗口处理案例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#11-pageObject%EF%BC%88PO%EF%BC%89%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F"><span class="nav-text">11. pageObject（PO）设计模式</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#12-pageObject%E5%8E%9F%E5%88%99"><span class="nav-text">12. pageObject原则</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#12-1-pageObject%E5%85%AD%E5%A4%A7%E5%8E%9F%E5%88%99"><span class="nav-text">12.1 pageObject六大原则</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#13-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E7%9A%84%E8%87%AA%E5%8A%A8%E5%8C%96%E7%99%BB%E5%BD%95"><span class="nav-text">13. 企业微信的自动化登录</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#13-1-Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95%E4%B9%8B%E5%A4%8D%E7%94%A8%E6%B5%8F%E8%A7%88%E5%99%A8"><span class="nav-text">13.1 Web自动化测试之复用浏览器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#13-1-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E5%AD%A6%E4%B9%A0%E5%A4%8D%E7%94%A8%E6%B5%8F%E8%A7%88%E5%99%A8"><span class="nav-text">13.1.1 为什么要学习复用浏览器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-1-2-%E5%A4%8D%E7%94%A8%E5%B7%B2%E6%9C%89%E6%B5%8F%E8%A7%88%E5%99%A8%E2%80%94%E9%85%8D%E7%BD%AE%E6%AD%A5%E9%AA%A4"><span class="nav-text">13.1.2 复用已有浏览器—配置步骤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E3%80%901%E3%80%91windows%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE%EF%BC%9A"><span class="nav-text">【1】windows环境变量配置：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E3%80%902%E3%80%91Mac%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%85%8D%E7%BD%AE"><span class="nav-text">【2】Mac环境变量配置</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-1-3-%E5%A4%8D%E7%94%A8%E5%B7%B2%E6%9C%89%E6%B5%8F%E8%A7%88%E5%99%A8%E2%80%94%E4%BB%A3%E7%A0%81%E8%AE%BE%E7%BD%AE"><span class="nav-text">13.1.3 复用已有浏览器—代码设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-1-3-%E5%A4%8D%E7%94%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%9E%E6%88%98%E6%BC%94%E7%A4%BA1"><span class="nav-text">13.1.3 复用浏览器实战演示1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-1-4-%E5%A4%8D%E7%94%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%9E%E6%88%98%E6%BC%94%E7%A4%BA2"><span class="nav-text">13.1.4 复用浏览器实战演示2</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-2-cookie"><span class="nav-text">13.2 cookie</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-1-cookie%E6%98%AF%E4%BB%80%E4%B9%88"><span class="nav-text">13.2.1 cookie是什么</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-2-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A6%81%E4%BD%BF%E7%94%A8Cookie%E8%87%AA%E5%8A%A8%E5%8C%96%E7%99%BB%E5%BD%95"><span class="nav-text">13.2.2 为什么要使用Cookie自动化登录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-3-%E4%BD%BF%E7%94%A8cookie%E7%99%BB%E5%BD%95"><span class="nav-text">13.2.3 使用cookie登录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-4-%E5%AE%9E%E6%88%98%E4%B9%8B%E8%8E%B7%E5%8F%96cookie"><span class="nav-text">13.2.4 实战之获取cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-5-%E5%AE%9E%E6%88%98%E4%B9%8Bcookie%E6%A4%8D%E5%85%A5"><span class="nav-text">13.2.5  实战之cookie植入</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#14-%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1web%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95%E5%AE%9E%E6%88%98"><span class="nav-text">14. 企业微信web端自动化测试实战</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-UI-%E8%87%AA%E5%8A%A8%E5%8C%96%E6%8A%80%E6%9C%AF"><span class="nav-text">( 1 ) UI 自动化技术</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-selenium3"><span class="nav-text">( 2 ) selenium3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B%E8%AE%BE%E8%AE%A1"><span class="nav-text">( 3 ) 自动化测试用例设计</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%901%E3%80%91%E4%BC%A0%E7%BB%9FUI%E4%BB%A3%E7%A0%81"><span class="nav-text">【1】传统UI代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%902%E3%80%91PO%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3"><span class="nav-text">【2】PO设计思想</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E3%80%903%E3%80%91%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1PO%E5%BB%BA%E6%A8%A1"><span class="nav-text">【3】企业微信PO建模</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="杨艺琳"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">杨艺琳</p>
  <div class="site-description" itemprop="description">我就是这条街最靓的仔</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">66</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">杨艺琳</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
